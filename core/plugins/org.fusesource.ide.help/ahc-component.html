<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>AHC Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="IDU-ActiveMQ.html" title="ActiveMQ"><link rel="next" href="ahc-ws-component.html" title="AHC Websocket Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="ahc-component"></a>AHC Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ahc-component.html#_uri_format">URI format</a></span></dt><dt><span class="section"><a href="ahc-component.html#_ahcendpoint_options">AhcEndpoint Options</a></span></dt><dt><span class="section"><a href="ahc-component.html#_ahccomponent_options">AhcComponent Options</a></span></dt><dt><span class="section"><a href="ahc-component.html#_message_headers">Message Headers</a></span></dt><dt><span class="section"><a href="ahc-component.html#_message_body">Message Body</a></span></dt><dt><span class="section"><a href="ahc-component.html#_response_code">Response code</a></span></dt><dt><span class="section"><a href="ahc-component.html#_ahcoperationfailedexception">AhcOperationFailedException</a></span></dt><dt><span class="section"><a href="ahc-component.html#_calling_using_get_or_post">Calling using GET or POST</a></span></dt><dt><span class="section"><a href="ahc-component.html#_configuring_uri_to_call">Configuring URI to call</a></span></dt><dt><span class="section"><a href="ahc-component.html#_configuring_uri_parameters">Configuring URI Parameters</a></span></dt><dt><span class="section"><a href="ahc-component.html#_how_to_set_the_http_method_to_the_http_producer">How to set the http method to the HTTP producer</a></span></dt><dt><span class="section"><a href="ahc-component.html#_configuring_charset">Configuring charset</a></span></dt><dt><span class="section"><a href="ahc-component.html#_configuring_asynchttpclient">Configuring AsyncHttpClient</a></span></dt><dt><span class="section"><a href="ahc-component.html#_ssl_support_https">SSL Support (HTTPS)</a></span></dt><dt><span class="section"><a href="ahc-component.html#_see_also">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 2.8</strong></span></p><p>The <span class="strong"><strong>ahc:</strong></span> component provides HTTP based endpoints
for consuming external HTTP resources (as a client to call external
servers using HTTP).
 The component uses the
<a class="link" href="https://github.com/AsyncHttpClient/async-http-client" target="_top">Async Http Client</a>
library.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-ahc<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format"></a>URI format</h2></div></div></div><pre class="programlisting">ahc:http:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//hostname[:port][/resourceUri][?options]</em>
ahc:https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//hostname[:port][/resourceUri][?options]</em></pre><p>Will by default use port 80 for HTTP and 443 for HTTPS.</p><p>You can append query options to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_ahcendpoint_options"></a>AhcEndpoint Options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ahc-component.html#_path_parameters_1_parameters">Path Parameters (1 parameters):</a></span></dt><dt><span class="section"><a href="ahc-component.html#_query_parameters_13_parameters">Query Parameters (13 parameters):</a></span></dt></dl></div><p>The AHC endpoint is configured using URI syntax:</p><pre class="screen">ahc:httpUri</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_1_parameters"></a>Path Parameters (1 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>httpUri</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The URI to use such as <a class="link" href="http://hostname:port/path" target="_top">http://hostname:port/path</a></p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>URI</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_13_parameters"></a>Query Parameters (13 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>bridgeEndpoint</strong></span> (producer)</p></td><td align="left" valign="top"><p>If the option is true, then the Exchange.HTTP_URI header is ignored, and use the endpoint&#8217;s URI for request. You may also set the throwExceptionOnFailure to be false to let the AhcProducer send all the fault response back.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>bufferSize</strong></span> (producer)</p></td><td align="left" valign="top"><p>The initial in-memory buffer size used when transferring data between Camel and AHC Client.</p></td><td align="center" valign="top"><p>4096</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>connectionClose</strong></span> (producer)</p></td><td align="left" valign="top"><p>Define if the Connection Close header has to be added to HTTP Request. This parameter is false by default</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>cookieHandler</strong></span> (producer)</p></td><td align="left" valign="top"><p>Configure a cookie handler to maintain a HTTP session</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>CookieHandler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>headerFilterStrategy</strong></span> (producer)</p></td><td align="left" valign="top"><p>To use a custom HeaderFilterStrategy to filter header to and from Camel message.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>HeaderFilterStrategy</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>throwExceptionOnFailure</strong></span> (producer)</p></td><td align="left" valign="top"><p>Option to disable throwing the AhcOperationFailedException in case of failed responses from the remote server. This allows you to get all responses regardless of the HTTP status code.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>transferException</strong></span> (producer)</p></td><td align="left" valign="top"><p>If enabled and an Exchange failed processing on the consumer side, and if the caused Exception was send back serialized in the response as a application/x-java-serialized-object content type (for example using Jetty or Servlet Camel components). On the producer side the exception will be deserialized and thrown as is, instead of the AhcOperationFailedException. The caused exception is required to be serialized. This is by default turned off. If you enable this then be aware that Java will deserialize the incoming data from the request to Java and that can be a potential security risk.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>binding</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom AhcBinding which allows to control how to bind between AHC and Camel.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AhcBinding</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>clientConfig</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To configure the AsyncHttpClient to use a custom com.ning.http.client.AsyncHttpClientConfig instance.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AsyncHttpClientConfig</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>clientConfigOptions</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To configure the AsyncHttpClientConfig using the key/values from the Map.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Map</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>clientConfigRealmOptions</strong></span> (security)</p></td><td align="left" valign="top"><p>To configure the AsyncHttpClientConfig Realm using the key/values from the Map.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Map</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sslContextParameters</strong></span> (security)</p></td><td align="left" valign="top"><p>Reference to a org.apache.camel.util.jsse.SSLContextParameters in the Registry. This reference overrides any configured SSLContextParameters at the component level. See Using the JSSE Configuration Utility. Note that configuring this option will override any SSL/TLS configuration options provided through the clientConfig option at the endpoint or component level.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SSLContextParameters</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_ahccomponent_options"></a>AhcComponent Options</h2></div></div></div><p>The AHC component supports 8 options which are listed below.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>client</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom AsyncHttpClient</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AsyncHttpClient</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>binding</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom AhcBinding which allows to control how to bind between AHC and Camel.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AhcBinding</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>clientConfig</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To configure the AsyncHttpClient to use a custom com.ning.http.client.AsyncHttpClientConfig instance.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AsyncHttpClientConfig</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sslContextParameters</strong></span> (security)</p></td><td align="left" valign="top"><p>Reference to a org.apache.camel.util.jsse.SSLContextParameters in the Registry. Note that configuring this option will override any SSL/TLS configuration options provided through the clientConfig option at the endpoint or component level.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SSLContextParameters</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>allowJavaSerialized Object</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether to allow java serialization when a request uses context-type=application/x-java-serialized-object This is by default turned off. If you enable this then be aware that Java will deserialize the incoming data from the request to Java and that can be a potential security risk.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>useGlobalSslContext Parameters</strong></span> (security)</p></td><td align="left" valign="top"><p>Enable usage of global SSL context parameters.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>headerFilterStrategy</strong></span> (filter)</p></td><td align="left" valign="top"><p>To use a custom org.apache.camel.spi.HeaderFilterStrategy to filter header to and from Camel message.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>HeaderFilterStrategy</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resolveProperty Placeholders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div><p>Notice that setting any of the options on the <code class="literal">AhcComponent</code> will
propagate those options to
<code class="literal">AhcEndpoints</code> being created. However the <code class="literal">AhcEndpoint</code> can also
configure/override a custom option. Options set on endpoints will always
take precedence over options from the <code class="literal">AhcComponent</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_message_headers"></a>Message Headers</h2></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="80%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_URI</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>URI to call. Will override existing URI set directly on the endpoint.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_PATH</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Request URI&#8217;s path, the header will be used to build the request URI
with the HTTP_URI. If the path is start with "/", http producer will try
to find the relative path based on the Exchange.HTTP_BASE_URI header or
the <code class="literal">exchange.getFromEndpoint().getEndpointUri();</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_QUERY</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Camel 2.11 onwards:</strong></span> URI parameters. Will override existing URI
parameters set directly on the endpoint.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_RESPONSE_CODE</code></p></td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>The HTTP response code from the external server. Is 200 for OK.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_CHARACTER_ENCODING</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Character encoding.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.CONTENT_TYPE</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The HTTP content type. Is set on both the IN and OUT message to provide
a content type, such as <code class="literal">text/html</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.CONTENT_ENCODING</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The HTTP content encoding. Is set on both the IN and OUT message to
provide a content encoding, such as <code class="literal">gzip</code>.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_message_body"></a>Message Body</h2></div></div></div><p>Camel will store the HTTP response from the external server on the OUT
body. All headers from the IN message will be copied to the OUT message,
so headers are preserved during routing. Additionally Camel will add the
HTTP response headers as well to the OUT message headers.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_response_code"></a>Response code</h2></div></div></div><p>Camel will handle according to the HTTP response code:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Response code is in the range 100..299, Camel regards it as a success
response.</li><li class="listitem">Response code is in the range 300..399, Camel regards it as a
redirection response and will throw a <code class="literal">AhcOperationFailedException</code> with
the information.</li><li class="listitem"><p class="simpara">Response code is 400+, Camel regards it as an external server failure
and will throw a <code class="literal">AhcOperationFailedException</code> with the information.</p><p class="simpara">throwExceptionOnFailure</p><p class="simpara">The option, <code class="literal">throwExceptionOnFailure</code>, can be set to <code class="literal">false</code> to prevent
the <code class="literal">AhcOperationFailedException</code> from being thrown for failed response
codes. This allows you to get any response from the remote server.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_ahcoperationfailedexception"></a>AhcOperationFailedException</h2></div></div></div><p>This exception contains the following information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">The HTTP status code</li><li class="listitem">The HTTP status line (text of the status code)</li><li class="listitem">Redirect location, if server returned a redirect</li><li class="listitem">Response body as a <code class="literal">java.lang.String</code>, if server provided a body as
response</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_calling_using_get_or_post"></a>Calling using GET or POST</h2></div></div></div><p>The following algorithm is used to determine if either <code class="literal">GET</code> or <code class="literal">POST</code>
HTTP method should be used:
 1. Use method provided in header.
 2. <code class="literal">GET</code> if query string is provided in header.
 3. <code class="literal">GET</code> if endpoint is configured with a query string.
 4. <code class="literal">POST</code> if there is data to send (body is not null).
 5. <code class="literal">GET</code> otherwise.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_uri_to_call"></a>Configuring URI to call</h2></div></div></div><p>You can set the HTTP producer&#8217;s URI directly form the endpoint URI. In
the route below, Camel will call out to the external server, <code class="literal">oldhost</code>,
using HTTP.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
        .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://oldhost"</em></strong>);</pre><p>And the equivalent Spring sample:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://activemq.apache.org/camel/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"ahc:http://oldhost"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre><p>You can override the HTTP endpoint URI by adding a header with the key,
<code class="literal">Exchange.HTTP_URI</code>, on the message.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .setHeader(Exchange.HTTP_URI, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://newhost"</em></strong>))
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://oldhost"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_uri_parameters"></a>Configuring URI Parameters</h2></div></div></div><p>The <span class="strong"><strong>ahc</strong></span> producer supports URI parameters to be sent to the HTTP
server. The URI parameters can either be set directly on the endpoint
URI or as a header with the key <code class="literal">Exchange.HTTP_QUERY</code> on the message.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
        .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://oldhost?order=123&amp;detail=short"</em></strong>);</pre><p>Or options provided in a header:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
            .setHeader(Exchange.HTTP_QUERY, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"order=123&amp;detail=short"</em></strong>))
        .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://oldhost"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_set_the_http_method_to_the_http_producer"></a>How to set the http method to the HTTP producer</h2></div></div></div><p>The HTTP component provides a way to set the HTTP request method by
setting the message header. Here is an example;</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
            .setHeader(Exchange.HTTP_METHOD, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"POST"</em></strong>))
        .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://www.google.com"</em></strong>)
            .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:results"</em></strong>);</pre><p>And the equivalent Spring sample:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://activemq.apache.org/camel/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;setHeader</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">headerName</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"CamelHttpMethod"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constant&gt;</strong>POST<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constant&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/setHeader&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"ahc:http://www.google.com"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:results"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_charset"></a>Configuring charset</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ahc-component.html#_uri_parameters_from_the_endpoint_uri">URI Parameters from the endpoint URI</a></span></dt><dt><span class="section"><a href="ahc-component.html#_uri_parameters_from_the_message">URI Parameters from the Message</a></span></dt><dt><span class="section"><a href="ahc-component.html#_getting_the_response_code">Getting the Response Code</a></span></dt></dl></div><p>If you are using <code class="literal">POST</code> to send data you can configure the <code class="literal">charset</code>
using the <code class="literal">Exchange</code> property:</p><pre class="programlisting">exchange.setProperty(Exchange.CHARSET_NAME, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"iso-8859-1"</em></strong>);</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_uri_parameters_from_the_endpoint_uri"></a>URI Parameters from the endpoint URI</h3></div></div></div><p>In this sample we have the complete URI endpoint that is just what you
would have typed in a web browser. Multiple URI parameters can of course
be set using the <code class="literal">&amp;</code> character as separator, just as you would in the
web browser. Camel does no tricks here.</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// we query for Camel at the Google page</em>
template.sendBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://www.google.com/search?q=Camel"</em></strong>, null);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_uri_parameters_from_the_message"></a>URI Parameters from the Message</h3></div></div></div><pre class="programlisting">Map headers = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> HashMap();
headers.put(Exchange.HTTP_QUERY, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"q=Camel&amp;lr=lang_en"</em></strong>);
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// we query for Camel and English language at Google</em>
template.sendBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://www.google.com/search"</em></strong>, null, headers);</pre><p>In the header value above notice that it should <span class="strong"><strong>not</strong></span> be prefixed with
<code class="literal">?</code> and you can separate parameters as usual with the <code class="literal">&amp;</code> char.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_getting_the_response_code"></a>Getting the Response Code</h3></div></div></div><p>You can get the HTTP response code from the AHC component by getting the
value from the Out message header with <code class="literal">Exchange.HTTP_RESPONSE_CODE</code>.</p><pre class="programlisting">Exchange exchange = template.send(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://www.google.com/search"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Processor() {
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> process(Exchange exchange) <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
                exchange.getIn().setHeader(Exchange.HTTP_QUERY, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"hl=en&amp;q=activemq"</em></strong>));
            }
   });
   Message out = exchange.getOut();
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">int</strong> responseCode = out.getHeader(Exchange.HTTP_RESPONSE_CODE, Integer.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_asynchttpclient"></a>Configuring AsyncHttpClient</h2></div></div></div><p>The <code class="literal">AsyncHttpClient</code> client uses a <code class="literal">AsyncHttpClientConfig</code> to configure
the client. See the documentation at
 <a class="link" href="http://github.com/sonatype/async-http-client" target="_top">Async Http Client</a> for
more details.</p><p>In Camel <span class="strong"><strong>2.8</strong></span>, configuration is limited to using the builder pattern
provided by <code class="literal">AsyncHttpClientConfig.Builder</code>. In Camel 2.8, the
<code class="literal">AsyncHttpClientConfig</code> doesn&#8217;t support getters/setters so its not easy
to create/configure using a Spring bean style (eg the &lt;bean&gt; tag in the
XML file).</p><p>The example below shows how to use a builder to create the
<code class="literal">AsyncHttpClientConfig</code> which we configure on the <code class="literal">AhcComponent</code>.</p><p>In Camel <span class="strong"><strong>2.9</strong></span>, the AHC component uses Async HTTP library 1.6.4. This
newer version provides added support for plain bean style configuration.
The <code class="literal">AsyncHttpClientConfigBean</code> class provides getters and setters for
the configuration options available in <code class="literal">AsyncHttpClientConfig</code>. An
instance of <code class="literal">AsyncHttpClientConfigBean</code> may be passed directly to the
AHC component or referenced in an endpoint URI using the <code class="literal">clientConfig</code>
URI parameter.</p><p>Also available in Camel <span class="strong"><strong>2.9</strong></span> is the ability to set configuration
options directly in the URI. URI parameters starting with
"clientConfig." can be used to set the various configurable properties
of <code class="literal">AsyncHttpClientConfig</code>. The properties specified in the endpoint URI
are merged with those specified in the configuration referenced by the
"clientConfig" URI parameter with those being set using the
"clientConfig." parameter taking priority. The <code class="literal">AsyncHttpClientConfig</code>
instance referenced is always copied for each endpoint such that
settings on one endpoint will remain independent of settings on any
previously created endpoints. The example below shows how to configure
the AHC component using the "clientConfig." type URI parameters.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc:http://localhost:8080/foo?clientConfig.maxRequestRetry=3&amp;clientConfig.followRedirects=true"</em></strong>)</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_ssl_support_https"></a>SSL Support (HTTPS)</h2></div></div></div><p><a name="AHC-UsingtheJSSEConfigurationUtility"></a>Using the JSSE Configuration Utility</p><p>As of Camel 2.9, the AHC component supports SSL/TLS configuration
through the <a class="link" href="camel-configuration-utilities.html" target="_top">Camel JSSE
Configuration Utility</a>.&nbsp; This utility greatly decreases the amount of
component specific code you need to write and is configurable at the
endpoint and component levels.&nbsp; The following examples demonstrate how
to use the utility with the AHC component.</p><p><a name="AHC-Programmaticconfigurationofthecomponent"></a>Programmatic configuration of the component</p><pre class="programlisting">KeyStoreParameters ksp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
ksp.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"/users/home/server/keystore.jks"</em></strong>);
ksp.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystorePassword"</em></strong>);

KeyManagersParameters kmp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyPassword"</em></strong>);

SSLContextParameters scp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SSLContextParameters();
scp.setKeyManagers(kmp);

AhcComponent component = context.getComponent(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ahc"</em></strong>, AhcComponent.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);
component.setSslContextParameters(scp));</pre><p><a name="AHC-SpringDSLbasedconfigurationofendpoint"></a>Spring DSL based configuration of endpoint</p><pre class="programlisting">...
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:sslContextParameters</strong>
      <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParameters"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:keyManagers</strong>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">keyPassword</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyPassword"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:keyStore</strong>
          <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/users/home/server/keystore.jks"</span>
          <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keystorePassword"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camel:keyManagers&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camel:sslContextParameters&gt;</strong>...
...
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"ahc:https://localhost/foo?sslContextParameters=#sslContextParameters"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
...</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_see_also"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Configuring Camel</li><li class="listitem">Component</li><li class="listitem">Endpoint</li><li class="listitem">Getting Started</li><li class="listitem"><a class="link" href="jetty-component.html" title="Jetty 9 Component">Jetty</a></li><li class="listitem"><a class="link" href="http-component.html" title="HTTP Component (deprecated)">HTTP</a></li><li class="listitem"><a class="link" href="http4-component.html" title="HTTP4 Component">HTTP4</a></li></ul></div></div></div></body></html>