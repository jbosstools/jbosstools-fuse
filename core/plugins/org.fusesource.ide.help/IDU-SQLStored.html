<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>SQL Stored Procedure</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-SQLComponent.html" title="SQL Component"><link rel="next" href="IDU-SSH.html" title="SSH"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-SQLStored"></a>SQL Stored Procedure</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e170037"></a>SQL Stored Procedure Component</h2></div></div></div><p><span class="bold"><strong>Available as of Camel 2.17</strong></span></p><p>The <span class="bold"><strong>sql-stored:</strong></span> component allows you to work with databases using JDBC Stored Procedure queries. This component is an extension to the SQL Component but specialized for calling stored procedures.</p><p>This component uses <code class="code">spring-jdbc</code> behind the scenes for the actual SQL
            handling.</p><p>Maven users will need to add the following dependency to their <code class="code">pom.xml</code> for this component:</p><pre class="programlisting">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-sql&lt;/artifactId&gt;
    &lt;version&gt;x.x.x&lt;/version&gt;
    &lt;!-- use the same version as your Camel core version --&gt;
&lt;/dependency&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e170060"></a>URI format</h2></div></div></div><p>The SQL component uses the following endpoint URI notation:</p><pre class="programlisting">sql-stored:template[?options]</pre><p>Where template is the stored procedure template, where you declare the name of the stored procedure and the IN and OUT arguments. </p><p>You can also refer to the template in a external file on the file system or classpath such as:</p><pre class="programlisting">sql-stored:classpath:sql/myprocedure.sql[?options]</pre><p>Where sql/myprocedure.sql is a plain text file in the classpath with the template, as show:</p><pre class="programlisting">SUBNUMBERS(
  INTEGER ${headers.num1},
  INTEGER ${headers.num2},
  OUT INTEGER resultofsub
)</pre><p> </p><p>You can append query options to the URI in the following format, <code class="code">?option=value&amp;option=value&amp;...</code></p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e170083"></a>Options</h2></div></div></div><table id="d0e170086"><tbody><tr><th>
<p>Option</p></th><th>
<p>Type</p></th><th>
<p>Default</p></th><th>
<p>Description</p></th></tr><tr><td>
<p><code class="code">batch</code></p></td><td>
<p><code class="code">boolean</code></p></td><td>
<p><code class="code">false</code></p></td><td>
<p>Enables or disables batch mode</p></td></tr><tr><td>
<p><code class="code">dataSource</code></p></td><td>
<p><code class="code">string</code></p></td><td>
<p> </p></td><td>
<p>Reference to a <code class="code">DataSource</code> to look up in the registry.</p></td></tr><tr><td>
<p><code class="code">noop</code></p></td><td>
<p><code class="code">boolean</code></p></td><td>
<p><code class="code">false</code></p></td><td>
<p>If set will ignore the results of the template and use the existing IN message as the OUT message for the continuation of processing</p></td></tr><tr><td><code class="code">outputHeader</code></td><td><code class="code">string</code></td><td> </td><td>Store the template result in a header instead of the message body. By default outputHeader == null and the template result is stored in the message body any existing content in the message body is discarded. If outputHeader is set the value is used as the name of the header to store the template result and the original message body is preserved.</td></tr><tr><td><code class="code">useMessageBodyForTemplate</code></td><td><code class="code">boolean</code></td><td><code class="code">false</code></td><td>Whether to use the message body as the template and then headers for parameters. If this option is enabled then the template in the uri is not used.</td></tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e170190"></a>Declaring the stored procedure template</h2></div></div></div><p>The template is declared using a syntax that would be similar to a Java method signature. The name of the stored procedure, and then the arguments enclosed in parenthesis. An example explains this well:</p><pre class="programlisting">&lt;to uri="sql-stored:SUBNUMBERS(INTEGER ${headers.num1},INTEGER ${headers.num2},OUT INTEGER resultofsub)"/&gt;</pre><p>The arguments is declared by a type and then the mapping to the Camel message using simple expression. So in this example the first two parameters are IN values that are INTEGER type, that maps to the message headers. The last parameter is the OUT value, also an INTEGER type.</p><p>In SQL term the stored procedure could be declared as:</p><pre class="programlisting">CREATE PROCEDURE SUBNUMBERS(VALUE1 INTEGER, VALUE2 INTEGER,OUT RESULT INTEGER)</pre></div></div></body></html>