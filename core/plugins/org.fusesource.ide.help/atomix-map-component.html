<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Atomix Map Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="atom-component.html" title="Atom Component"><link rel="next" href="atomix-messaging-component.html" title="Atomix Messaging Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="atomix-map-component"></a>Atomix Map Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="atomix-map-component.html#_uri_format_8">URI format</a></span></dt><dt><span class="section"><a href="atomix-map-component.html#_options_5">Options</a></span></dt><dt><span class="section"><a href="atomix-map-component.html#_headers">Headers</a></span></dt><dt><span class="section"><a href="atomix-map-component.html#_configuring_the_component_to_connect_to_an_atomix_cluster">Configuring the component to connect to an Atomix cluster</a></span></dt><dt><span class="section"><a href="atomix-map-component.html#_usage_examples">Usage examples:</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 2.20</strong></span></p><p>The camel atomix-map component allows you to work with <a class="link" href="http://atomix.io/atomix/" target="_top">Atomix&#8217;s</a> <a class="link" href="http://atomix.io/atomix/docs/collections/#distributedmap" target="_top">Distributed Map</a> collection.</p><p>Maven users will need to add the following dependency to their pom.xml for this component:</p><pre class="programlisting">    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
        &lt;artifactId&gt;camel-atomix&lt;/artifactId&gt;
        &lt;version&gt;${camel-version}&lt;/version&gt;
    &lt;/dependency&gt;</pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format_8"></a>URI format</h2></div></div></div><pre class="programlisting">    atomix-map:mapName</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_options_5"></a>Options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="atomix-map-component.html#_path_parameters_1_parameters_7">Path Parameters (1 parameters):</a></span></dt><dt><span class="section"><a href="atomix-map-component.html#_query_parameters_18_parameters_2">Query Parameters (18 parameters):</a></span></dt></dl></div><p>The Atomix Map component supports 5 options which are listed below.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>configuration</strong></span> (common)</p></td><td align="left" valign="top"><p>The shared component configuration</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AtomixMapConfiguration</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>atomix</strong></span> (common)</p></td><td align="left" valign="top"><p>The shared AtomixClient instance</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AtomixClient</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>nodes</strong></span> (common)</p></td><td align="left" valign="top"><p>The nodes the AtomixClient should connect to</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>List</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>configurationUri</strong></span> (common)</p></td><td align="left" valign="top"><p>The path to the AtomixClient configuration</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resolveProperty Placeholders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div><p>The Atomix Map endpoint is configured using URI syntax:</p><pre class="screen">atomix-map:resourceName</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_1_parameters_7"></a>Path Parameters (1 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>resourceName</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The distributed resource name</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_18_parameters_2"></a>Query Parameters (18 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>atomix</strong></span> (common)</p></td><td align="left" valign="top"><p>The Atomix instance to use</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Atomix</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>configurationUri</strong></span> (common)</p></td><td align="left" valign="top"><p>The Atomix configuration uri.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>defaultAction</strong></span> (common)</p></td><td align="left" valign="top"><p>The default action.</p></td><td align="center" valign="top"><p>PUT</p></td><td align="left" valign="top"><p>Action</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>key</strong></span> (common)</p></td><td align="left" valign="top"><p>The key to use if none is set in the header or to listen for events for a specific key.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Object</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>nodes</strong></span> (common)</p></td><td align="left" valign="top"><p>The address of the nodes composing the cluster.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resultHeader</strong></span> (common)</p></td><td align="left" valign="top"><p>The header that wil carry the result.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>transport</strong></span> (common)</p></td><td align="left" valign="top"><p>Sets the Atomix transport.</p></td><td align="center" valign="top"><p>io.atomix.catalyst.transport.netty.NettyTransport</p></td><td align="left" valign="top"><p>Transport</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>ttl</strong></span> (common)</p></td><td align="left" valign="top"><p>The resource ttl.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>bridgeErrorHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler, which mean any exceptions occurred while the consumer is trying to pickup incoming messages, or the likes, will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exceptionHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExceptionHandler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exchangePattern</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExchangePattern</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>defaultResourceConfig</strong></span> (advanced)</p></td><td align="left" valign="top"><p>The cluster wide default resource configuration.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Properties</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>defaultResourceOptions</strong></span> (advanced)</p></td><td align="left" valign="top"><p>The local default resource options.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Properties</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>ephemeral</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets if the local member should join groups as PersistentMember or not. If set to ephemeral the local member will receive an auto generated ID thus the local one is ignored.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>readConsistency</strong></span> (advanced)</p></td><td align="left" valign="top"><p>The read consistency level.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ReadConsistency</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resourceConfigs</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Cluster wide resources configuration.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Map</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resourceOptions</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Local resources configurations</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Map</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_headers"></a>Headers</h2></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="11%" class="col_2"><col width="19%" class="col_3"><col width="60%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Type</th><th align="left" valign="top">Values</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>CamelAtomixResourceAction</p></td><td align="left" valign="top"><p>AtomixMap.Action</p></td><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">PUT</li><li class="listitem">PUT_IF_ABSENT</li><li class="listitem">GET</li><li class="listitem">CLEAR</li><li class="listitem">SIZE</li><li class="listitem">CONTAINS_KEY</li><li class="listitem">CONTAINS_VALUE</li><li class="listitem">IS_EMPTY</li><li class="listitem">ENTRY_SET</li><li class="listitem">REMOVE</li><li class="listitem">REPLACE</li><li class="listitem">VALUES</li></ul></div></td><td align="left" valign="top"><p>The action to perform</p></td></tr><tr><td align="left" valign="top"><p>CamelAtomixResourceKey</p></td><td align="left" valign="top"><p>Object</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The key to operate on</p></td></tr><tr><td align="left" valign="top"><p>CamelAtomixResourceValue</p></td><td align="left" valign="top"><p>Object</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The value, if missing In Body is used</p></td></tr><tr><td align="left" valign="top"><p>CamelAtomixResourceOldValue</p></td><td align="left" valign="top"><p>Object</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The old value</p></td></tr><tr><td align="left" valign="top"><p>CamelAtomixResourceTTL</p></td><td align="left" valign="top"><p>String / long</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The entry TTL</p></td></tr><tr><td align="left" valign="top"><p>CamelAtomixResourceReadConsistency</p></td><td align="left" valign="top"><p>ReadConsistency</p></td><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">ATOMIC</li><li class="listitem">ATOMIC_LEASE</li><li class="listitem">SEQUENTIAL</li><li class="listitem">LOCAL</li></ul></div></td><td align="left" valign="top"><p>The read consistency level</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_the_component_to_connect_to_an_atomix_cluster"></a>Configuring the component to connect to an Atomix cluster</h2></div></div></div><p>The nodes of the Atomix cluster you want to join can be se at Endpoint or component level (recommended), below some examples:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>Endpoint:</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;beans</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"..."</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"atomix-map:myMap?nodes=node-1.atomix.cluster:8700,node-2.atomix.cluster:8700"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/beans&gt;</strong></pre></li><li class="listitem"><p class="simpara"><span class="strong"><strong>Component:</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;beans</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"..."</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"atomix-map"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.atomix.client.map.AtomixMapComponent"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"nodes"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"nodes=node-1.atomix.cluster:8700,node-2.atomix.cluster:8700"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"atomix-map:myMap"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/beans&gt;</strong></pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_usage_examples"></a>Usage examples:</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>PUT an element with TTL of 1 second:</strong></span></p><pre class="programlisting">FluentProducerTemplate.on(context)
    .withHeader(AtomixClientConstants.RESOURCE_ACTION, AtomixMap.Action.PUT)
    .withHeader(AtomixClientConstants.RESOURCE_KEY, key)
    .withHeader(AtomixClientConstants.RESOURCE_TTL, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"1s"</em></strong>)
    .withBody(val)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .send();</pre></li></ul></div></div></div></body></html>