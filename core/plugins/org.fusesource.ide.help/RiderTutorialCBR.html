<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>To Add a Content-Based Router</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="description" content="This tutorial walks you through adding a content-based router with logging to a route."><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="RiderTutorials.html" title="Tutorials"><link rel="prev" href="RiderTutorialRun.html" title="To Run a Route"><link rel="next" href="RiderTutorialTrace.html" title="To Trace a Message Through a Route"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="RiderTutorialCBR"></a>To Add a Content-Based Router</h1></div><div><div class="abstract"><p>This tutorial walks you through adding a content-based router
                with logging to a route.</p></div></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e10887"></a>Goals</h2></div></div></div><p>In this tutorial you will:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>add a content-based router to your route</p></li><li class="listitem"><p>configure the content-based router</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>add a log endpoint to each output branch of the
                    content-based router</p></li><li class="listitem"><p>add a SetHeader EIP after each log endpoint</p></li><li class="listitem"><p>add an Otherwise branch to the content-based router</p></li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e10909"></a>Prerequisites</h2></div></div></div><p>To complete this tutorial you will need the <span class="bold"><strong>CBRroute</strong></span>
            project you created in <a class="xref" href="RiderTutorialCreate.html" title="To Create a New Route"><i>To Create a New Route</i></a>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e10919"></a>Adding and configuring a content-based router</h2></div></div></div><p>To add and configure a content-based router for your route:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>In <span class="guilabel">Project Explorer</span>, double-click
                        <code class="filename">CBRroute/src/main/resources/OSGI-INF/blueprint/camelContext.xml</code>
                    to open your <span class="guilabel">CBRroute</span> project.</p></li><li class="step"><p>Select the connector joining the two <span class="guimenu">file:</span> nodes
                        <code class="code">file:src/data?noop=true</code> and
                        <code class="code">file:target/messages/others</code>.</p></li><li class="step"><p>Right-click it to open the context menu, and select 
                        <span class="guimenuitem">Remove</span> to delete the connector.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Alternatively, you can delete the connector by
                        selecting it, then selecting
                            <span class="guimenuitem">Delete</span> from the toolbar's
                            <span class="guimenu">Edit</span> menu.</p></td></tr></table></div></li><li class="step"><p>On the canvas, select the terminal <span class="guimenu">file:</span> node,
                        <code class="code">file:target/messages/others</code>, and in the
                        <span class="guilabel">Properties</span> editor, change the <span class="guilabel">Uri</span>
                    and <span class="guilabel">Id</span> properties to:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="guilabel">Uri:</span>&#8212;<strong class="userinput"><code>file:target/messages/validOrders</code></strong></p></li><li class="listitem"><p><span class="guilabel">Id:</span>&#8212;<strong class="userinput"><code>toValid</code></strong></p></li></ul></div><p> Then drag the node out of the way. You will connect it to
                    another node later in this tutorial.</p></li><li class="step"><p>On the canvas, select the starting <span class="guilabel">file:</span> node,
                        <code class="code">file:src/data?noop=true</code>, and right-click it to open the context
                    menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Routing</span> &gt; <span class="guimenuitem">Choice</span>.</p><p>A <span class="guilabel">choice</span> node (<span class="inlinemediaobject"><img src="images/ChoiceElement.jpg" width="20.499999999999996" alt="choice icon"></span>) appears on the canvas connected to the starting
                        <span class="guilabel">file:</span> node.</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="./images/tutRte1ChoicePropEdNew.png" align="middle" width="375.7"></div></div></li><li class="step"><p>In the <span class="guilabel">Properties</span> editor, enter
                        <strong class="userinput"><code>choice1</code></strong> in the <span class="guilabel">Id</span> field.</p></li><li class="step"><p>On the canvas, select the <span class="guilabel">choice</span>
                    node, then right-click it to open the context menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Routing</span> &gt; <span class="guimenuitem">When</span>.</p><p>A <span class="guilabel">when</span> node appears on the canvas connected to the
                        <span class="guilabel">choice</span> node. The <span class="guilabel">Properties</span> editor
                    opens, displaying the <span class="guilabel">when</span> node's property fields for you
                    to edit, as shown:</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="./images/tutPropEdErrorWarn.png" align="middle" width="388.7"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When a required property is blank, the <span class="guilabel">Properties</span>
                        editor marks it with <span class="inlinemediaobject"><img src="./images/error.gif" width="9.6" alt="error icon"></span>. The number of properties that require configuring is
                        displayed in the title bar. Error icons and message disappear when you
                        configure the required properties.</p></td></tr></table></div></li><li class="step"><p>In the <span class="guilabel">Expression</span> field, enter
                        <strong class="userinput"><code>/order/orderline/quantity/text() &gt;
                        /order/orderline/maxAllowed/text()</code></strong> .</p><p>This expression determines which messages will transit
                    this path in the route.</p></li><li class="step"><p>From the <span class="guilabel">Language</span> drop-down menu,
                    select <span class="guilabel">xpath</span>.</p></li><li class="step"><p>In the <span class="guilabel">Id</span> field, enter
                        <strong class="userinput"><code>when1</code></strong>.</p><p><a class="xref" href="RiderTutorialCBR.html#tutWhen1Configed" title="Figure&nbsp;14.&nbsp;when1 configuration">Figure&nbsp;14</a> shows the
                        <span class="guilabel">when1</span> node configured.</p><div class="figure"><a name="tutWhen1Configed"></a><p class="title"><b>Figure&nbsp;14.&nbsp;when1 configuration</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="./images/tutWhen1propEd.png" align="middle" width="480.99999999999994" alt="when1 configuration"></div></div></div><br class="figure-break"></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11138"></a>Adding and configuring logging</h2></div></div></div><p>To add logging to your route:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>On the canvas, select the <span class="guilabel">when1</span> node,
                    and then right-click it to open the context menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Components</span> &gt; <span class="guimenuitem">Log</span>.</p><p>A <span class="bold"><strong>log</strong></span> node appears on the canvas, connected
                    to the <span class="bold"><strong>when1</strong></span> node. The
                        <span class="guilabel">Properties</span> editor opens, displaying the
                        <span class="guilabel">log</span> node's property fields for you to edit.</p></li><li class="step"><p>In the <span class="guilabel">Message</span> field, enter <strong class="userinput"><code>quantity requested
                    exceeds the maximum allowed - contact customer</code></strong>.</p></li><li class="step"><p>In the <span class="guilabel">Id</span> field, enter
                    <strong class="userinput"><code>log1</code></strong>.</p><p><a class="xref" href="RiderTutorialCBR.html#log1PropsConfigured" title="Figure&nbsp;15.&nbsp;Log1 configuration">Figure&nbsp;15</a> shows
                    the <span class="bold"><strong>log1</strong></span> node configured.</p><div class="figure"><a name="log1PropsConfigured"></a><p class="title"><b>Figure&nbsp;15.&nbsp;Log1 configuration</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="./images/tutLog1PropEd.png" align="middle" width="328.90000000000003" alt="Log1 configuration"></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In <span class="guilabel">Fuse Integration</span> perspective's
                            <span class="guilabel">Messages View</span>, the tooling
                        inserts the contents of the log node's
                            <span class="guilabel">Id</span> field in the <code class="code">Trace
                            Node Id</code> column for message instances, when
                        tracing is enabled on the route (see <a class="xref" href="RiderTutorialTrace.html#TutMessageTrace" title="Figure&nbsp;29.&nbsp;Fuse Integration perspective's message tracing components">Figure&nbsp;29</a>). In the <span class="guilabel">Console</span>, it adds the
                        contents of the log node's <span class="guilabel">Message</span>
                        field to the log data whenever the route runs.</p></td></tr></table></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11228"></a>Adding and configuring message headers</h2></div></div></div><p>To add and configure message headers:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>On the canvas, select the <span class="guilabel">log1</span> node,
                    and then right-click it to open the context menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Transformation</span> &gt; <span class="guimenuitem">SetHeader</span>.</p><p>A <span class="bold"><strong>setHeader</strong></span> node (<span class="inlinemediaobject"><img src="./images/setBody.png" width="21.25" alt="setHeader icon"></span>) appears on the canvas, connected to the <span class="bold"><strong>log 1</strong></span> node. The <span class="guilabel">Properties</span>
                    editor opens, displaying the <span class="guilabel">setHeader</span> node's property
                    fields for you to edit, as shown:</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="./images/tutSetHead1PropEdNew.png" align="middle" width="361.8"></div></div></li><li class="step"><p>In the <span class="guilabel">Header Name</span> field, enter
                        <strong class="userinput"><code>Destination</code></strong>.</p></li><li class="step"><p>In the <span class="guilabel">Expression</span> field, enter
                        <strong class="userinput"><code>InvalidOrders</code></strong>.</p></li><li class="step"><p>Select <span class="guimenuitem">constant</span> from the
                        <span class="guimenu">Language</span> drop-down menu. </p></li><li class="step"><p>In the <span class="guilabel">Id</span> field, enter
                        <strong class="userinput"><code>setHead1</code></strong>.</p><p><a class="xref" href="RiderTutorialCBR.html#tutSetHead1configed" title="Figure&nbsp;16.&nbsp;setHead1 configuration">Figure&nbsp;16</a> shows
                    the <span class="guimenuitem">setHead1</span> node configured.</p><div class="figure"><a name="tutSetHead1configed"></a><p class="title"><b>Figure&nbsp;16.&nbsp;setHead1 configuration</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="./images/tutSetHead1PropEd.png" align="middle" width="361.8" alt="setHead1 configuration"></div></div></div><br class="figure-break"></li><li class="step"><p>On the canvas, select the <span class="guilabel">setHead1</span>
                    node, and then right-click it to open the context
                    menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Components</span> &gt; <span class="guimenuitem">File</span>.</p><p>A <span class="bold"><strong>file:directoryName</strong></span> node appears on the
                    canvas, connected to the <span class="bold"><strong>setHead1</strong></span> node. The
                        <span class="guilabel">Properties</span> editor opens, displaying the
                        <span class="guilabel">file:directoryName</span> node's property fields for you to
                    edit.</p></li><li class="step"><p>On the <span class="guilabel">Generic</span> tab, replace
                        <em class="replaceable"><code>directoryName</code></em> with
                        <strong class="userinput"><code>target/messages/invalidOrders</code></strong> in the
                        <span class="guilabel">Uri</span> field, and enter <strong class="userinput"><code>toInvalid</code></strong>
                    in the <span class="guilabel">Id</span> field.</p></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11376"></a>Adding and configuring an otherwise branch</h2></div></div></div><p>To add and configure the otherwise branch to your route:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>On the canvas, reselect the <span class="bold"><strong>Choice</strong></span> node, then right-click it to open the
                    context menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Routing</span> &gt; <span class="guimenuitem">Otherwise</span>.</p><p>An <span class="bold"><strong>otherwise</strong></span> node appears on the canvas,
                    connected to the <span class="bold"><strong>choice</strong></span> node. The
                        <span class="guilabel">Properties</span> editor opens, displaying the
                        <span class="guilabel">otherwise</span> node's property fields for you to
                    edit.</p></li><li class="step"><p>In the <span class="guilabel">Id</span> field, enter
                        <strong class="userinput"><code>else2</code></strong> .</p><p>The <span class="bold"><strong>else2</strong></span> node will eventually route to the
                    terminal <span class="bold"><strong>file:</strong></span> node
                        (<code class="code">file:target/messages/validOrders</code>) any message that does not
                    match the XPath expression set for the <span class="bold"><strong>when1</strong></span>
                    node.</p></li><li class="step"><p>On the canvas, select the <span class="guilabel">else2</span> node,
                    and then right-click it to open the context menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Components</span> &gt; <span class="guimenuitem">Log</span>.</p><p>A <span class="bold"><strong>log</strong></span> node appears on the canvas, connected
                    to the <span class="bold"><strong>else2</strong></span> node. The
                        <span class="guilabel">Properties</span> editor opens, displaying the
                        <span class="guilabel">log</span> node's property fields for you to edit.</p></li><li class="step"><p>In the <span class="guilabel">Message</span> field, enter <strong class="userinput"><code>valid order -
                        process</code></strong>, and in the <span class="guilabel">Id</span> field, enter
                        <strong class="userinput"><code>log2</code></strong>.</p></li><li class="step"><p>On the canvas, select the <span class="guilabel">log2</span> node,
                    and then right-click it to open the context menu.</p></li><li class="step"><p>Select <span class="guimenu">Add</span> &gt; <span class="guisubmenu">Transformation</span> &gt; <span class="guimenuitem">SetHeader</span>.</p><p>A <span class="bold"><strong>setHeader</strong></span> node (<span class="inlinemediaobject"><img src="./images/setBody.png" width="21.25" alt="setHeader icon"></span>) appears on the canvas, connected to
                    the <span class="bold"><strong>log2</strong></span> node. The
                        <span class="guilabel">Properties</span> editor opens, displaying
                    the <span class="guilabel">setHeader</span> node's property fields
                    for you to edit.</p></li><li class="step"><p>In the <span class="guilabel">Header Name</span> field, enter
                        <strong class="userinput"><code>Destination</code></strong>.</p></li><li class="step"><p>In the <span class="guilabel">Expression</span> field, enter
                        <strong class="userinput"><code>Dispatcher</code></strong>.</p></li><li class="step"><p>Select <span class="guimenuitem">constant</span> from the
                        <span class="guimenu">Language</span> drop-down menu. </p></li><li class="step"><p>In the <span class="guilabel">Id</span> field, enter
                        <strong class="userinput"><code>setHead2</code></strong>.</p></li><li class="step"><p>On the canvas, drag the terminal <span class="guilabel">file:</span> node,
                        <code class="filename">file:target/messages/validOrders</code>, close to the
                        <span class="guilabel">setHead2</span> node.</p></li><li class="step"><p>Select the <span class="bold"><strong>setHead2</strong></span> node, and then drag its
                    connector arrow (<span class="inlinemediaobject"><img src="images/ConnectorArrow.jpg" width="16.799999999999997" alt="connector arrow icon"></span>) to the terminal <span class="guilabel">file:</span> node and
                    release it.</p></li><li class="step"><p>To quickly realign all of the nodes on the canvas,
                    right-click the canvas to open the context menu, and then
                    select <span class="guimenuitem">Layout Diagram</span>.</p><p>The route on the canvas should resemble <a class="xref" href="RiderTutorialCBR.html#RiderTutorialCBRImg020" title="Figure&nbsp;17.&nbsp;Completed content-based router with logs and message headers">Figure&nbsp;17</a>.</p><div class="figure"><a name="RiderTutorialCBRImg020"></a><p class="title"><b>Figure&nbsp;17.&nbsp;Completed content-based router with logs and  message
                        headers</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="./images/simpleCBRroute.png" align="middle" width="594.75" alt="content-based route with logging and message headers"></div></div></div><br class="figure-break"></li><li class="step"><p>On the toolbar, select <span class="guimenu">File</span> &gt; <span class="guimenuitem">Save</span> to save the completed route.</p></li><li class="step"><p>Click the <span class="guilabel">Source</span> tab at the bottom,
                    left of the canvas to display the XML for the route.</p><p>The <code class="sgmltag-element">camelContext</code> element will
                    look like that shown in <a class="xref" href="RiderTutorialCBR.html#CBREx010" title="Example&nbsp;3.&nbsp;XML for content-based router">Example&nbsp;3</a>.</p><div class="example"><a name="CBREx010"></a><p class="title"><b>Example&nbsp;3.&nbsp;XML for content-based router</b></p><div class="example-contents"><pre class="programlisting"><span xmlns="http://www.w3.org/1999/xhtml" class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;blueprint</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.osgi.org/xmlns/blueprint/v1.0.0"</span>
       <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns:camel</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/blueprint"</span>
       <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.osgi.org/xmlns/blueprint/v1.0.0 
           http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
       http://camel.apache.org/schema/blueprint 
           http://camel.apache.org/schema/blueprint/camel-blueprint.xsd"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>

  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">trace</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"false"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/blueprint"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"file:src/data?noop=true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;choice</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"choice1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;when</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"when1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xpath&gt;</strong>/order/orderline/quantity/text() &gt; /order/orderline/maxAllowed/text()<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/xpath&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;log</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">message</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"quantity requested exceeds maximum allowed - contact customer"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"log1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;setHeader</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">headerName</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"Destination"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"setHead1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constant&gt;</strong>InvalidOrders<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constant&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/setHeader&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"file:target/messages/invalidOrders"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"toInvalid"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/when&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;otherwise</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"else2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;log</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">message</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"valid order - process"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"log2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;setHeader</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">headerName</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"Destination"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"setHead2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constant&gt;</strong>Dispatcher<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constant&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/setHeader&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"file:target/messages/validOrders"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"toValid"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/otherwise&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/choice&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
 <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/blueprint&gt;</strong></pre></div></div><br class="example-break"></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11631"></a>Next steps</h2></div></div></div><p>You can run the new route as described in <a class="xref" href="RiderTutorialRun.html#RiderRunRun" title="Running the route">Running the route</a>.</p><p>After you run it, you can easily verify whether the route executed
            properly  by checking the target destinations in <span class="guilabel">Project
                Explorer</span>:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Select <code class="filename">CBRroute</code>. </p></li><li class="step"><p>Right-click it to open the context menu, then select
                    <span class="guimenuitem">Refresh</span>.</p></li><li class="step"><p>Under the project root node
                    (<span class="guilabel">CBRroute</span>), locate the folder
                        <code class="filename">target/messages/</code> and expand it, as
                    shown in <a class="xref" href="RiderTutorialCBR.html#tutSimpCBRTarget" title="Figure&nbsp;18.&nbsp;Target message destinations in Project Explorer">Figure&nbsp;18</a>.</p><div class="figure"><a name="tutSimpCBRTarget"></a><p class="title"><b>Figure&nbsp;18.&nbsp;Target message destinations in Project Explorer </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/tutSimpCBRrouteVerify.png" align="middle" width="113.85" alt="message destinations"></div></div></div><br class="figure-break"></li><li class="step"><p>Check that the <code class="filename">target/messages/invalidOrders</code> folder
                                contains <code class="filename">message2.xml</code> and
                                    <code class="filename">message4.xml</code>.</p><p>In these messages, the value of the
                                    <span class="property">quantity</span> element should
                                exceed the value of the
                                    <span class="property">maxAllowed</span>
                                element.</p></li><li class="step"><p>Check that the <code class="filename">target/messages/validOrders</code> folder contains the four
                                message files that contain valid orders:
                                    <code class="filename">message1.xml</code>,
                                    <code class="filename">message3.xml</code> ,
                                    <code class="filename">message5.xml</code> and
                                    <code class="filename">message6.xml</code>.</p><p>In these messages, the value of the
                                    <span class="property">quantity</span> element should
                                be less than or equal to the value of the
                                    <span class="property">maxAllowed</span>
                                element.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>To view message  content, double-click each message to
                    open it in the route editor's xml editor.</p></td></tr></table></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11725"></a>Further reading</h2></div></div></div><p>To learn more about message enrichment see:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>the <a class="link" href="https://access.redhat.com/site/documentation/en-US/Red_Hat_JBoss_Fuse/6.2/html/Apache_Camel_Development_Guide/index.html" target="_top">Red Hat JBoss Fuse: Apache Camel Development
                        Guide</a>
                </p></li><li class="listitem"><p>the <a class="link" href="https://access.redhat.com/site/documentation/JBoss_Fuse/" target="_top">Red Hat JBoss Fuse 6.x documentation</a>
                </p></li></ul></div></div></div></body></html>