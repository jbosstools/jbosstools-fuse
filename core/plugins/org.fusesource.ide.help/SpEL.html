<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>SpEL</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling"><link rel="up" href="RiderExLang.html" title="Part&nbsp;III.&nbsp;Expression and Predicates Languages"><link rel="prev" href="Simple.html" title="The Simple Language"><link rel="next" href="SQL.html" title="JoSQL"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="SpEL"></a>SpEL</h2></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="topic-33210"></a>Overview</h2></div></div></div><p>The <a class="link" href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/expressions.html" target="_top"> Spring Expression Language (SpEL)</a> is an object graph navigation language provided
with Spring 3, which can be used to construct predicates and expressions in a route. A notable
feature of SpEL is the ease with which you can access beans from the registry.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="topic-33211"></a>Syntax</h2></div></div></div><p>The SpEL expressions must use the placeholder syntax,
<code class="literal">#{<span class="emphasis"><em>SpelExpression</em></span>}</code>, so that they can be embedded in
a plain text string (in other words, SpEL has expression templating enabled).</p><p>SpEL can also look up beans in the registry (typically, the Spring registry), using the
<code class="literal">@<span class="emphasis"><em>BeanID</em></span></code> syntax. For example, given a bean with the
ID, <code class="literal">headerUtils</code>, and the method, <code class="literal">count()</code> (which counts the number of
headers on the current message), you could use the <code class="literal">headerUtils</code> bean in an SpEL
predicate, as follows:</p><pre class="screen">#{@headerUtils.count &gt; 4}</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="topic-33212"></a>Adding SpEL package</h2></div></div></div><p>To use SpEL in your routes you need to add a dependency on <code class="literal">camel-spring</code>
to your project as shown in <a class="xref" href="SpEL.html#SpEL-ExSpring" title="Example&nbsp;19.&nbsp;Adding the camel-spring dependency">Example&nbsp;19, &#8220;Adding the camel-spring dependency&#8221;</a>.</p><div class="example"><a name="SpEL-ExSpring"></a><p class="title"><b>Example&nbsp;19.&nbsp;Adding the camel-spring dependency</b></p><div class="example-contents"><pre class="screen">&lt;!-- Maven POM File --&gt;
&lt;properties&gt;
  &lt;camel-version&gt;2.21.0.fuse-730078-redhat-00001&lt;/camel-version&gt;
  ...
&lt;/properties&gt;

&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-spring&lt;/artifactId&gt;
    &lt;version&gt;${camel-version}&lt;/version&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;</pre></div></div><br class="example-break"></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="topic-33213"></a>Variables</h2></div></div></div><p><a class="xref" href="SpEL.html#SpEL-TableVARS" title="Table&nbsp;20.&nbsp;SpEL variables">Table&nbsp;20, &#8220;SpEL variables&#8221;</a> lists the variables that are accessible when using
SpEL.</p><div class="table"><a name="SpEL-TableVARS"></a><p class="title"><b>Table&nbsp;20.&nbsp;SpEL variables</b></p><div class="table-contents"><table summary="SpEL variables" border="1"><colgroup><col width="33%" class="col_1"><col width="33%" class="col_2"><col width="34%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Variable</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">this</code></p></td><td align="left" valign="top"><p><code class="literal">Exchange</code></p></td><td align="left" valign="top"><p>The current exchange is the root object.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">exchange</code></p></td><td align="left" valign="top"><p><code class="literal">Exchange</code></p></td><td align="left" valign="top"><p>The current exchange.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">exchangeId</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The current exchange&#8217;s ID.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">exception</code></p></td><td align="left" valign="top"><p><code class="literal">Throwable</code></p></td><td align="left" valign="top"><p>The exchange exception (if any).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fault</code></p></td><td align="left" valign="top"><p><code class="literal">Message</code></p></td><td align="left" valign="top"><p>The fault message (if any).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p><code class="literal">Message</code></p></td><td align="left" valign="top"><p>The exchange&#8217;s <span class="strong"><strong>In</strong></span> message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">response</code></p></td><td align="left" valign="top"><p><code class="literal">Message</code></p></td><td align="left" valign="top"><p>The exchange&#8217;s <span class="strong"><strong>Out</strong></span> message (if any).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">properties</code></p></td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p>The exchange properties.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">property(<span class="emphasis"><em>Name</em></span>)</code></p></td><td align="left" valign="top"><p><code class="literal">Object</code></p></td><td align="left" valign="top"><p>The exchange property keyed by <span class="emphasis"><em>Name</em></span>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">property(<span class="emphasis"><em>Name</em></span>,
                <span class="emphasis"><em>Type</em></span>)</code></p></td><td align="left" valign="top"><p><code class="literal">Type</code></p></td><td align="left" valign="top"><p>The exchange property keyed by <span class="emphasis"><em>Name</em></span>, converted to the
              type, <span class="emphasis"><em>Type</em></span>.</p></td></tr></tbody></table></div></div><br class="table-break"></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="topic-33214"></a>XML example</h2></div></div></div><p>For example, to select only those messages whose <code class="literal">Country</code> header has the value
<code class="literal">USA</code>, you can use the following SpEL expression:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"SourceURL"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;filter&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;spel&gt;</strong>#{request.headers['Country'] == 'USA'}}<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/spel&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"TargetURL"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/filter&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="topic-33215"></a>Java example</h2></div></div></div><p>You can define the same route in the Java DSL, as follows:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"SourceURL"</em></strong>)
  .filter().spel(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"#{request.headers['Country'] == 'USA'}"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"TargetURL"</em></strong>);</pre><p>The following example shows how to embed SpEL expressions within a plain text
string:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"SourceURL"</em></strong>)
  .setBody(spel(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Hello #{request.body}! What a beautiful #{request.headers['dayOrNight']}"</em></strong>))
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"TargetURL"</em></strong>);</pre></div></div></body></html>