<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>MongoDB Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="mock-component.html" title="Mock Component"><link rel="next" href="mongodb-gridfs-component.html" title="MongoDB GridFS Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="mongodb-component"></a>MongoDB Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_uri_format_125">URI format</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_mongodb_options">MongoDB options</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_configuration_of_database_in_spring_xml">Configuration of database in Spring XML</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_sample_route">Sample route</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_mongodb_operations_producer_endpoints">MongoDB operations - producer endpoints</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_tailable_cursor_consumer">Tailable Cursor Consumer</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_how_the_tailable_cursor_consumer_works">How the tailable cursor consumer works</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_persistent_tail_tracking">Persistent tail tracking</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_enabling_persistent_tail_tracking">Enabling persistent tail tracking</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_oplog_tail_tracking">Oplog Tail Tracking</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_type_conversions">Type conversions</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_see_also_78">See also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 2.10</strong></span></p><p>According to Wikipedia: "NoSQL is a movement promoting a loosely defined
class of non-relational data stores that break with a long history of
relational databases and ACID guarantees." NoSQL solutions have grown in
popularity in the last few years, and major extremely-used sites and
services such as Facebook, LinkedIn, Twitter, etc. are known to use them
extensively to achieve scalability and agility.</p><p>Basically, NoSQL solutions differ from traditional RDBMS (Relational
Database Management Systems) in that they don&#8217;t use SQL as their query
language and generally don&#8217;t offer ACID-like transactional behaviour nor
relational data. Instead, they are designed around the concept of
flexible data structures and schemas (meaning that the traditional
concept of a database table with a fixed schema is dropped), extreme
scalability on commodity hardware and blazing-fast processing.</p><p>MongoDB is a very popular NoSQL solution and the camel-mongodb component
integrates Camel with MongoDB allowing you to interact with MongoDB
collections both as a producer (performing operations on the collection)
and as a consumer (consuming documents from a MongoDB collection).</p><p>MongoDB revolves around the concepts of documents (not as is office
documents, but rather hierarchical data defined in JSON/BSON) and
collections. This component page will assume you are familiar with them.
Otherwise, visit <a class="link" href="http://www.mongodb.org/" target="_top">http://www.mongodb.org/</a>.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-mongodb<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.y.z<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format_125"></a>URI format</h2></div></div></div><pre class="programlisting">mongodb:connectionBean?database=databaseName&amp;collection=collectionName&amp;operation=operationName[&amp;moreOptions...]</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_mongodb_options"></a>MongoDB options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_path_parameters_1_parameters_122">Path Parameters (1 parameters):</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_query_parameters_23_parameters">Query Parameters (23 parameters):</a></span></dt></dl></div><p>The MongoDB component has no options.</p><p>The MongoDB endpoint is configured using URI syntax:</p><pre class="screen">mongodb:connectionBean</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_1_parameters_122"></a>Path Parameters (1 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>connectionBean</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> Name of com.mongodb.Mongo to use.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_23_parameters"></a>Query Parameters (23 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>collection</strong></span> (common)</p></td><td align="left" valign="top"><p>Sets the name of the MongoDB collection to bind to this endpoint</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>collectionIndex</strong></span> (common)</p></td><td align="left" valign="top"><p>Sets the collection index (JSON FORMAT : field1 : order1, field2 : order2)</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>createCollection</strong></span> (common)</p></td><td align="left" valign="top"><p>Create collection during initialisation if it doesn&#8217;t exist. Default is true.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>database</strong></span> (common)</p></td><td align="left" valign="top"><p>Sets the name of the MongoDB database to target</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>operation</strong></span> (common)</p></td><td align="left" valign="top"><p>Sets the operation this endpoint will execute against MongoDB. For possible values, see MongoDbOperation.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MongoDbOperation</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>outputType</strong></span> (common)</p></td><td align="left" valign="top"><p>Convert the output of the producer to the selected type : DBObjectList DBObject or DBCursor. DBObjectList or DBCursor applies to findAll and aggregate. DBObject applies to all other operations.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MongoDbOutputType</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>writeConcern</strong></span> (common)</p></td><td align="left" valign="top"><p>Set the WriteConcern for write operations on MongoDB using the standard ones. Resolved from the fields of the WriteConcern class by calling the link WriteConcernvalueOf(String) method.</p></td><td align="center" valign="top"><p>ACKNOWLEDGED</p></td><td align="left" valign="top"><p>WriteConcern</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>bridgeErrorHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler, which mean any exceptions occurred while the consumer is trying to pickup incoming messages, or the likes, will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exceptionHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExceptionHandler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exchangePattern</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExchangePattern</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>cursorRegenerationDelay</strong></span> (advanced)</p></td><td align="left" valign="top"><p>MongoDB tailable cursors will block until new data arrives. If no new data is inserted, after some time the cursor will be automatically freed and closed by the MongoDB server. The client is expected to regenerate the cursor if needed. This value specifies the time to wait before attempting to fetch a new cursor, and if the attempt fails, how long before the next attempt is made. Default value is 1000ms.</p></td><td align="center" valign="top"><p>1000</p></td><td align="left" valign="top"><p>long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>dynamicity</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether this endpoint will attempt to dynamically resolve the target database and collection from the incoming Exchange properties. Can be used to override at runtime the database and collection specified on the otherwise static endpoint URI. It is disabled by default to boost performance. Enabling it will take a minimal performance hit.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>readPreference</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets a MongoDB ReadPreference on the Mongo connection. Read preferences set directly on the connection will be overridden by this setting. The link ReadPreferencevalueOf(String) utility method is used to resolve the passed readPreference value. Some examples for the possible values are nearest, primary or secondary etc.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ReadPreference</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>writeResultAsHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>In write operations, it determines whether instead of returning WriteResult as the body of the OUT message, we transfer the IN message to the OUT and attach the WriteResult as a header.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>persistentId</strong></span> (tail)</p></td><td align="left" valign="top"><p>One tail tracking collection can host many trackers for several tailable consumers. To keep them separate, each tracker should have its own unique persistentId.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>persistentTailTracking</strong></span> (tail)</p></td><td align="left" valign="top"><p>Enable persistent tail tracking, which is a mechanism to keep track of the last consumed message across system restarts. The next time the system is up, the endpoint will recover the cursor from the point where it last stopped slurping records.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>persistRecords</strong></span> (tail)</p></td><td align="left" valign="top"><p>Sets the number of tailed records after which the tail tracking data is persisted to MongoDB.</p></td><td align="center" valign="top"><p>-1</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>tailTrackCollection</strong></span> (tail)</p></td><td align="left" valign="top"><p>Collection where tail tracking information will be persisted. If not specified, link MongoDbTailTrackingConfigDEFAULT_COLLECTION will be used by default.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>tailTrackDb</strong></span> (tail)</p></td><td align="left" valign="top"><p>Indicates what database the tail tracking mechanism will persist to. If not specified, the current database will be picked by default. Dynamicity will not be taken into account even if enabled, i.e. the tail tracking database will not vary past endpoint initialisation.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>tailTrackField</strong></span> (tail)</p></td><td align="left" valign="top"><p>Field where the last tracked value will be placed. If not specified, link MongoDbTailTrackingConfigDEFAULT_FIELD will be used by default.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>tailTrackIncreasingField</strong></span> (tail)</p></td><td align="left" valign="top"><p>Correlation field in the incoming record which is of increasing nature and will be used to position the tailing cursor every time it is generated. The cursor will be (re)created with a query of type: tailTrackIncreasingField lastValue (possibly recovered from persistent tail tracking). Can be of type Integer, Date, String, etc. NOTE: No support for dot notation at the current time, so the field should be at the top level of the document.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>tailTrackingStrategy</strong></span> (tail)</p></td><td align="left" valign="top"><p>Sets the strategy used to extract the increasing field value and to create the query to position the tail cursor.</p></td><td align="center" valign="top"><p>LITERAL</p></td><td align="left" valign="top"><p>MongoDBTailTracking Enum</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuration_of_database_in_spring_xml"></a>Configuration of database in Spring XML</h2></div></div></div><p>The following Spring XML creates a bean defining the connection to a
MongoDB instance.</p><pre class="programlisting"><span xmlns="http://www.w3.org/1999/xhtml" class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;beans</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.springframework.org/schema/beans"</span>
    <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mongoBean"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"com.mongodb.Mongo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"host"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"${mongodb.host}"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"port"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"${mongodb.port}"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/beans&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sample_route"></a>Sample route</h2></div></div></div><p>The following route defined in Spring XML executes the operation
<a class="link" href="mongodb-component.html" title="MongoDB Component"><span class="strong"><strong>dbStats</strong></span></a> on a collection.</p><p><span class="strong"><strong>Get DB stats for specified collection</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- using bean 'mongoBean' defined above --&gt;</em>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mongodb:mongoBean?database=${mongodb.database}&amp;amp;collection=${mongodb.collection}&amp;amp;operation=getDbStats"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_mongodb_operations_producer_endpoints"></a>MongoDB operations - producer endpoints</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_query_operations">Query operations</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_create_update_operations">Create/update operations</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_delete_operations_2">Delete operations</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_bulk_write_operations">Bulk Write Operations</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_other_operations">Other operations</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_dynamic_operations">Dynamic operations</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_operations"></a>Query operations</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_findbyid">findById</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_findonebyquery">findOneByQuery</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_findall">findAll</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_count">count</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_specifying_a_fields_filter_projection">Specifying a fields filter (projection)</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_specifying_a_sort_clause">Specifying a sort clause</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_findbyid"></a>findById</h4></div></div></div><p>This operation retrieves only one element from the collection whose _id
field matches the content of the IN message body. The incoming object
can be anything that has an equivalent to a BSON type. See
<a class="link" href="http://bsonspec.org/" target="_top">http://bsonspec.org/</a><span class="marked">/specification[<a class="link" href="http://bsonspec.org/" target="_top">http://bsonspec.org/</a></span>/specification]
and
<a class="link" href="http://www.mongodb.org/display/DOCS/Java+Types" target="_top">http://www.mongodb.org/display/DOCS/Java+Types</a>.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findById"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findById"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultFindById"</em></strong>);</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Supports optional parameters</strong></span>. This operation supports specifying a fields filter. See
<a class="link" href="mongodb-component.html" title="MongoDB Component">Specifying optional parameters</a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_findonebyquery"></a>findOneByQuery</h4></div></div></div><p>Use this operation to retrieve just one element from the collection that
matches a MongoDB query. <span class="strong"><strong>The query object is extracted from the IN
message body</strong></span>, i.e. it should be of type <code class="literal">DBObject</code> or convertible to
<code class="literal">DBObject</code>. It can be a JSON String or a Hashmap. See
<a class="link" href="mongodb-component.html" title="MongoDB Component">#Type conversions</a> for more info.</p><p>Example with no query (returns any object of the collection):</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findOneByQuery"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findOneByQuery"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultFindOneByQuery"</em></strong>);</pre><p>Example with a query (returns one matching result):</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findOneByQuery"</em></strong>)
    .setBody().constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{ \"name\": \"Raul Kripalani\" }"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findOneByQuery"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultFindOneByQuery"</em></strong>);</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Supports optional parameters</strong></span>. This operation supports specifying a fields filter and/or a sort clause. See
<a class="link" href="mongodb-component.html" title="MongoDB Component">Specifying optional parameters</a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_findall"></a>findAll</h4></div></div></div><p>The <code class="literal">findAll</code> operation returns all documents matching a query, or none
at all, in which case all documents contained in the collection are
returned. <span class="strong"><strong>The query object is extracted from the IN message body</strong></span>, i.e.
it should be of type <code class="literal">DBObject</code> or convertible to <code class="literal">DBObject</code>. It can be
a JSON String or a Hashmap. See <a class="link" href="mongodb-component.html" title="MongoDB Component">#Type conversions</a> for
more info.</p><p>Example with no query (returns all object in the collection):</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findAll"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findAll"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultFindAll"</em></strong>);</pre><p>Example with a query (returns all matching results):</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findAll"</em></strong>)
    .setBody().constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{ \"name\": \"Raul Kripalani\" }"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findAll"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultFindAll"</em></strong>);</pre><p>Paging and efficient retrieval is supported via the following headers:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Header key</th><th align="left" valign="top">Quick constant</th><th align="left" valign="top">Description (extracted from MongoDB API doc)</th><th align="left" valign="top">Expected type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbNumToSkip</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.NUM_TO_SKIP</code></p></td><td align="left" valign="top"><p>Discards a given number of elements at the beginning of the cursor.</p></td><td align="left" valign="top"><p>int/Integer</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbLimit</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.LIMIT</code></p></td><td align="left" valign="top"><p>Limits the number of elements returned.</p></td><td align="left" valign="top"><p>int/Integer</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbBatchSize</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.BATCH_SIZE</code></p></td><td align="left" valign="top"><p>Limits the number of elements returned in one batch. A cursor typically
fetches a batch of result objects and store them locally. If batchSize
is positive, it represents the size of each batch of objects retrieved.
It can be adjusted to optimize performance and limit data transfer. If
batchSize is negative, it will limit of number objects returned, that
fit within the max batch size limit (usually 4MB), and cursor will be
closed. For example if batchSize is -10, then the server will return a
maximum of 10 documents and as many as can fit in 4MB, then close the
cursor. Note that this feature is different from limit() in that
documents must fit within a maximum size, and it removes the need to
send a request to close the cursor server-side. The batch size can be
changed even after a cursor is iterated, in which case the setting will
apply on the next batch retrieval.</p></td><td align="left" valign="top"><p>int/Integer</p></td></tr></tbody></table></div><p>You can also "stream" the documents returned from the server into your route by including outputType=DBCursor (Camel 2.16+) as an endpoint option
which may prove simpler than setting the above headers. This hands your Exchange the DBCursor from the Mongo driver, just as if you were executing
the findAll() within the Mongo shell, allowing your route to iterate over the results. By default and without this option, this component will load
the documents from the driver&#8217;s cursor into a List and return this to your route - which may result in a large number of in-memory objects. Remember,
with a DBCursor do not ask for the number of documents matched - see the MongoDB documentation site for details.</p><p>Example with option outputType=DBCursor and batch size :</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findAll"</em></strong>)
    .setHeader(MongoDbConstants.BATCH_SIZE).constant(<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">10</span>)
    .setBody().constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{ \"name\": \"Raul Kripalani\" }"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findAll&amp;outputType=DBCursor"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultFindAll"</em></strong>);</pre><p>The <code class="literal">findAll</code> operation will also return the following OUT headers to
enable you to iterate through result pages if you are using paging:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Header key</th><th align="left" valign="top">Quick constant</th><th align="left" valign="top">Description (extracted from MongoDB API doc)</th><th align="left" valign="top">Data type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbResultTotalSize</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.RESULT_TOTAL_SIZE</code></p></td><td align="left" valign="top"><p>Number of objects matching the query. This does not take limit/skip into
consideration.</p></td><td align="left" valign="top"><p>int/Integer</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbResultPageSize</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.RESULT_PAGE_SIZE</code></p></td><td align="left" valign="top"><p>Number of objects matching the query. This does not take limit/skip into
consideration.</p></td><td align="left" valign="top"><p>int/Integer</p></td></tr></tbody></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Supports optional parameters</strong></span>. This operation supports specifying a fields filter and/or a sort clause. See
<a class="link" href="mongodb-component.html" title="MongoDB Component">Specifying optional parameters</a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_count"></a>count</h4></div></div></div><p>Returns the total number of objects in a collection, returning a Long as
the OUT message body.
The following example will count the number of records in the
"dynamicCollectionName" collection. Notice how dynamicity is enabled,
and as a result, the operation will not run against the
"notableScientists" collection, but against the "dynamicCollectionName"
collection.</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// from("direct:count").to("mongodb:myDb?database=tickets&amp;collection=flights&amp;operation=count&amp;dynamicity=true");</em>
Long result = template.requestBodyAndHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:count"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"irrelevantBody"</em></strong>, MongoDbConstants.COLLECTION, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"dynamicCollectionName"</em></strong>);
assertTrue(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Result is not of type Long"</em></strong>, result <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">instanceof</strong> Long);</pre><p>From&nbsp;<span class="strong"><strong>Camel 2.14</strong></span>&nbsp;onwards you can provide
a&nbsp;<code class="literal">com.mongodb.DBObject</code>&nbsp;object in the message body as a query,&nbsp;and
operation will return the amount of documents matching this criteria.&nbsp;</p><p>&nbsp;</p><pre class="programlisting">DBObject query = ...
Long count = template.requestBodyAndHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:count"</em></strong>, query, MongoDbConstants.COLLECTION, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"dynamicCollectionName"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_specifying_a_fields_filter_projection"></a>Specifying a fields filter (projection)</h4></div></div></div><p>Query operations will, by default, return the matching objects in their
entirety (with all their fields). If your documents are large and you
only require retrieving a subset of their fields, you can specify a
field filter in all query operations, simply by setting the relevant
<code class="literal">DBObject</code> (or type convertible to <code class="literal">DBObject</code>, such as a JSON String,
Map, etc.) on the <code class="literal">CamelMongoDbFieldsFilter</code> header, constant shortcut:
<code class="literal">MongoDbConstants.FIELDS_FILTER</code>.</p><p>Here is an example that uses MongoDB&#8217;s BasicDBObjectBuilder to simplify
the creation of DBObjects. It retrieves all fields except <code class="literal">_id</code> and
<code class="literal">boringField</code>:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("direct:findAll").to("mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=findAll")</em>
DBObject fieldFilter = BasicDBObjectBuilder.start().add(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"_id"</em></strong>, <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span>).add(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"boringField"</em></strong>, <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span>).get();
Object result = template.requestBodyAndHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:findAll"</em></strong>, (Object) null, MongoDbConstants.FIELDS_FILTER, fieldFilter);</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_specifying_a_sort_clause"></a>Specifying a sort clause</h4></div></div></div><p>There is a often a requirement to fetch the min/max record from a
collection based on sorting by a particular field. In Mongo the
operation is performed using syntax similar to:</p><pre class="screen">db.collection.find().sort({_id: -1}).limit(1)
// or
db.collection.findOne({$query:{},$orderby:{_id:-1}})</pre><p>In a Camel route the SORT_BY header can be used with the findOneByQuery
operation to achieve the same result. If the FIELDS_FILTER header is also
specified the operation will return a single field/value pair
that can be passed directly to another component (for example, a
parameterized MyBatis SELECT query). This example demonstrates fetching
the temporally newest document from a collection and reducing the result
to a single field, based on the <code class="literal">documentTimestamp</code> field:</p><pre class="programlisting">.from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:someTriggeringEvent"</em></strong>)
.setHeader(MongoDbConstants.SORT_BY).constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{\"documentTimestamp\": -1}"</em></strong>)
.setHeader(MongoDbConstants.FIELDS_FILTER).constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{\"documentTimestamp\": 1}"</em></strong>)
.setBody().constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{}"</em></strong>)
.to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=local&amp;collection=myDemoCollection&amp;operation=findOneByQuery"</em></strong>)
.to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:aMyBatisParameterizedSelect"</em></strong>)
;</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_create_update_operations"></a>Create/update operations</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_insert">insert</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_save">save</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_update">update</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_insert"></a>insert</h4></div></div></div><p>Inserts an new object into the MongoDB collection, taken from the IN
message body. Type conversion is attempted to turn it into <code class="literal">DBObject</code> or
a <code class="literal">List</code>.
 Two modes are supported: single insert and multiple insert. For
multiple insert, the endpoint will expect a List, Array or Collections
of objects of any type, as long as they are - or can be converted to -
<code class="literal">DBObject</code>. All objects are inserted at once. The endpoint will
intelligently decide which backend operation to invoke (single or
multiple insert) depending on the input.</p><p>Example:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:insert"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=insert"</em></strong>);</pre><p>The operation will return a WriteResult, and depending on the
<code class="literal">WriteConcern</code> or the value of the <code class="literal">invokeGetLastError</code> option,
<code class="literal">getLastError()</code> would have been called already or not. If you want to
access the ultimate result of the write operation, you need to retrieve
the <code class="literal">CommandResult</code> by calling <code class="literal">getLastError()</code> or
<code class="literal">getCachedLastError()</code> on the <code class="literal">WriteResult</code>. Then you can verify the
result by calling <code class="literal">CommandResult.ok()</code>,
<code class="literal">CommandResult.getErrorMessage()</code> and/or <code class="literal">CommandResult.getException()</code>.</p><p>Note that the new object&#8217;s <code class="literal">_id</code> must be unique in the collection. If
you don&#8217;t specify the value, MongoDB will automatically generate one for
you. But if you do specify it and it is not unique, the insert operation
will fail (and for Camel to notice, you will need to enable
invokeGetLastError or set a WriteConcern that waits for the write
result).</p><p>This is not a limitation of the component, but it is how things work in
MongoDB for higher throughput. If you are using a custom <code class="literal">_id</code>, you are
expected to ensure at the application level that is unique (and this is
a good practice too).</p><p>Since Camel <span class="strong"><strong>2.15</strong></span>: OID(s) of the inserted record(s) is stored in the
message header under&nbsp;<code class="literal">CamelMongoOid</code> key (<code class="literal">MongoDbConstants.OID</code>
constant). The value stored is&nbsp;<code class="literal">org.bson.types.ObjectId</code> for single
insert or <code class="literal">java.util.List&lt;org.bson.types.ObjectId&gt;</code> if multiple records
have been inserted.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_save"></a>save</h4></div></div></div><p>The save operation is equivalent to an <span class="emphasis"><em>upsert</em></span> (UPdate, inSERT)
operation, where the record will be updated, and if it doesn&#8217;t exist, it
will be inserted, all in one atomic operation. MongoDB will perform the
matching based on the _id field.</p><p>Beware that in case of an update, the object is replaced entirely and
the usage of
<a class="link" href="http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations" target="_top">MongoDB&#8217;s
$modifiers</a> is not permitted. Therefore, if you want to manipulate the
object if it already exists, you have two options:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">perform a query to retrieve the entire object first along with all
its fields (may not be efficient), alter it inside Camel and then save
it.</li><li class="listitem">use the update operation with
<a class="link" href="http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations" target="_top">$modifiers</a>,
which will execute the update at the server-side instead. You can enable
the upsert flag, in which case if an insert is required, MongoDB will
apply the $modifiers to the filter query object and insert the result.</li></ol></div><p>For example:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:insert"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=save"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_update"></a>update</h4></div></div></div><p>Update one or multiple records on the collection. Requires a
List&lt;DBObject&gt; as the IN message body containing exactly 2 elements:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Element 1 (index 0) &#8658; filter query &#8658; determines what objects will be
affected, same as a typical query object</li><li class="listitem">Element 2 (index 1) &#8658; update rules &#8658; how matched objects will be
updated. All
<a class="link" href="http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations" target="_top">modifier
operations</a> from MongoDB are supported.</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Multiupdates</strong></span> . By default, MongoDB will only update 1 object even if multiple objects
match the filter query. To instruct MongoDB to update <span class="strong"><strong>all</strong></span> matching
records, set the <code class="literal">CamelMongoDbMultiUpdate</code> IN message header to <code class="literal">true</code>.</p></td></tr></table></div><p>A header with key <code class="literal">CamelMongoDbRecordsAffected</code> will be returned
(<code class="literal">MongoDbConstants.RECORDS_AFFECTED</code> constant) with the number of
records updated (copied from <code class="literal">WriteResult.getN()</code>).</p><p>Supports the following IN message headers:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Header key</th><th align="left" valign="top">Quick constant</th><th align="left" valign="top">Description (extracted from MongoDB API doc)</th><th align="left" valign="top">Expected type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbMultiUpdate</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.MULTIUPDATE</code></p></td><td align="left" valign="top"><p>If the update should be applied to all objects matching. See
<a class="link" href="http://www.mongodb.org/display/DOCS/Atomic+Operations" target="_top">http://www.mongodb.org/display/DOCS/Atomic+Operations</a></p></td><td align="left" valign="top"><p>boolean/Boolean</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbUpsert</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.UPSERT</code></p></td><td align="left" valign="top"><p>If the database should create the element if it does not exist</p></td><td align="left" valign="top"><p>boolean/Boolean</p></td></tr></tbody></table></div><p>For example, the following will update <span class="strong"><strong>all</strong></span> records whose filterField
field equals true by setting the value of the "scientist" field to
"Darwin":</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("direct:update").to("mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=update");</em>
DBObject filterField = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"filterField"</em></strong>, true);
DBObject updateObj = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"$set"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"scientist"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Darwin"</em></strong>));
Object result = template.requestBodyAndHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:update"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Object[] {filterField, updateObj}, MongoDbConstants.MULTIUPDATE, true);</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_delete_operations_2"></a>Delete operations</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_remove">remove</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_remove"></a>remove</h4></div></div></div><p>Remove matching records from the collection. The IN message body will
act as the removal filter query, and is expected to be of type
<code class="literal">DBObject</code> or a type convertible to it.
 The following example will remove all objects whose field
'conditionField' equals true, in the science database, notableScientists
collection:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("direct:remove").to("mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=remove");</em>
DBObject conditionField = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"conditionField"</em></strong>, true);
Object result = template.requestBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:remove"</em></strong>, conditionField);</pre><p>A header with key <code class="literal">CamelMongoDbRecordsAffected</code> is returned
(<code class="literal">MongoDbConstants.RECORDS_AFFECTED</code> constant) with type <code class="literal">int</code>,
containing the number of records deleted (copied from
<code class="literal">WriteResult.getN()</code>).</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_bulk_write_operations"></a>Bulk Write Operations</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_bulkwrite">bulkWrite</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_bulkwrite"></a>bulkWrite</h4></div></div></div><p><span class="strong"><strong>Available as of Camel 2.21</strong></span></p><p>Performs write operations in bulk with controls for order of execution.
Requires a <code class="literal">List&lt;WriteModel&lt;DBObject&gt;&gt;</code> as the IN message body containing commands for insert, update, and delete operations.</p><p>The following example will insert a new scientist "Pierre Curie", update record with id "5" by setting the value of the "scientist" field to
"Marie Curie" and delete record with id "3" :</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("direct:bulkWrite").to("mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=bulkWrite");</em>
List&lt;WriteModel&lt;DBObject&gt;&gt; bulkOperations = Arrays.asList(
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> InsertOneModel&lt;&gt;(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"scientist"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Pierre Curie"</em></strong>)),
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> UpdateOneModel&lt;&gt;(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"_id"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"5"</em></strong>),
                                 <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"$set"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"scientist"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Marie Curie"</em></strong>))),
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DeleteOneModel&lt;&gt;(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"_id"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"3"</em></strong>)));

BulkWriteResult result = template.requestBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:bulkWrite"</em></strong>, bulkOperations, BulkWriteResult.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);</pre><p>By default, operations are executed in order and interrupted on the first write error without processing any remaining write operations in the list.
To instruct MongoDB to continue to process remaining write operations in the list, set the <code class="literal">CamelMongoDbBulkOrdered</code> IN message header to <code class="literal">false</code>.
Unordered operations are executed in parallel and this behavior is not guaranteed.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Header key</th><th align="left" valign="top">Quick constant</th><th align="left" valign="top">Description (extracted from MongoDB API doc)</th><th align="left" valign="top">Expected type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbBulkOrdered</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.BULK_ORDERED</code></p></td><td align="left" valign="top"><p>Perform an ordered or unordered operation execution. Defaults to true.</p></td><td align="left" valign="top"><p>boolean/Boolean</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_other_operations"></a>Other operations</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mongodb-component.html#_aggregate">aggregate</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_getdbstats">getDbStats</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_getcolstats">getColStats</a></span></dt><dt><span class="section"><a href="mongodb-component.html#_command">command</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_aggregate"></a>aggregate</h4></div></div></div><p><span class="strong"><strong>Available as of Camel 2.14</strong></span></p><p>Perform a aggregation with the given pipeline contained in the
body.
<span class="strong"><strong>Aggregations could be long and heavy operations. Use with care.</strong></span></p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("direct:aggregate").to("mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=aggregate");</em>
from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:aggregate"</em></strong>)
    .setBody().constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"[{ $match : {$or : [{\"scientist\" : \"Darwin\"},{\"scientist\" : \"Einstein\"}]}},{ $group: { _id: \"$scientist\", count: { $sum: 1 }} } ]"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=aggregate"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultAggregate"</em></strong>);</pre><p>Supports the following IN message headers:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Header key</th><th align="left" valign="top">Quick constant</th><th align="left" valign="top">Description (extracted from MongoDB API doc)</th><th align="left" valign="top">Expected type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbBatchSize</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.BATCH_SIZE</code></p></td><td align="left" valign="top"><p>Sets the number of documents to return per batch.</p></td><td align="left" valign="top"><p>int/Integer</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelMongoDbAllowDiskUse</code></p></td><td align="left" valign="top"><p><code class="literal">MongoDbConstants.ALLOW_DISK_USE</code></p></td><td align="left" valign="top"><p>Enable aggregation pipeline stages to write data to temporary files.</p></td><td align="left" valign="top"><p>boolean/Boolean</p></td></tr></tbody></table></div><p>Efficient retrieval is supported via outputType=DBCursor.</p><p>You can also "stream" the documents returned from the server into your route by including outputType=DBCursor (Camel 2.21+) as an endpoint option
which may prove simpler than setting the above headers. This hands your Exchange the DBCursor from the Mongo driver, just as if you were executing
the aggregate() within the Mongo shell, allowing your route to iterate over the results. By default and without this option, this component will load
the documents from the driver&#8217;s cursor into a List and return this to your route - which may result in a large number of in-memory objects. Remember,
with a DBCursor do not ask for the number of documents matched - see the MongoDB documentation site for details.</p><p>Example with option outputType=DBCursor and batch size:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("direct:aggregate").to("mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=aggregate");</em>
from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:aggregate"</em></strong>)
    .setHeader(MongoDbConstants.BATCH_SIZE).constant(<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">10</span>)
    .setBody().constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"[{ $match : {$or : [{\"scientist\" : \"Darwin\"},{\"scientist\" : \"Einstein\"}]}},{ $group: { _id: \"$scientist\", count: { $sum: 1 }} } ]"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=science&amp;collection=notableScientists&amp;operation=aggregate&amp;outputType=DBCursor"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:resultAggregate"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_getdbstats"></a>getDbStats</h4></div></div></div><p>Equivalent of running the <code class="literal">db.stats()</code> command in the MongoDB shell,
which displays useful statistic figures about the database.
 For example:</p><pre class="programlisting">&gt; db.stats();
{
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"db"</em></strong> : <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"test"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"collections"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">7</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"objects"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">719</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"avgObjSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">59.73296244784423</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"dataSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">42948</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"storageSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1000058880</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"numExtents"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">9</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"indexes"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">4</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"indexSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">32704</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"fileSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1275068416</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"nsSizeMB"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">16</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ok"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>
}</pre><p>Usage example:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// from("direct:getDbStats").to("mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=getDbStats");</em>
Object result = template.requestBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:getDbStats"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"irrelevantBody"</em></strong>);
assertTrue(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Result is not of type DBObject"</em></strong>, result <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">instanceof</strong> DBObject);</pre><p>The operation will return a data structure similar to the one displayed
in the shell, in the form of a <code class="literal">DBObject</code> in the OUT message body.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_getcolstats"></a>getColStats</h4></div></div></div><p>Equivalent of running the <code class="literal">db.collection.stats()</code> command in the MongoDB
shell, which displays useful statistic figures about the collection.
 For example:</p><pre class="programlisting">&gt; db.camelTest.stats();
{
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ns"</em></strong> : <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"test.camelTest"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"count"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">100</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"size"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">5792</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"avgObjSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">57.92</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"storageSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">20480</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"numExtents"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"nindexes"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"lastExtentSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">16384</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"paddingFactor"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"flags"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"totalIndexSize"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">8176</span>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"indexSizes"</em></strong> : {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"_id_"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">8176</span>
    },
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ok"</em></strong> : <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>
}</pre><p>Usage example:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// from("direct:getColStats").to("mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=getColStats");</em>
Object result = template.requestBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:getColStats"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"irrelevantBody"</em></strong>);
assertTrue(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Result is not of type DBObject"</em></strong>, result <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">instanceof</strong> DBObject);</pre><p>The operation will return a data structure similar to the one displayed
in the shell, in the form of a <code class="literal">DBObject</code> in the OUT message body.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_command"></a>command</h4></div></div></div><p><span class="strong"><strong>Available as of Camel 2.15</strong></span></p><p>Run the body as a command on database. Usefull for admin operation as
getting host informations, replication or sharding status.</p><p>Collection parameter is not use for this operation.</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// route: from("command").to("mongodb:myDb?database=science&amp;operation=command");</em>
DBObject commandBody = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicDBObject(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"hostInfo"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"1"</em></strong>);
Object result = template.requestBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:command"</em></strong>, commandBody);</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_dynamic_operations"></a>Dynamic operations</h3></div></div></div><p>An Exchange can override the endpoint&#8217;s fixed operation by setting the
<code class="literal">CamelMongoDbOperation</code> header, defined by the
<code class="literal">MongoDbConstants.OPERATION_HEADER</code> constant.
 The values supported are determined by the MongoDbOperation enumeration
and match the accepted values for the <code class="literal">operation</code> parameter on the
endpoint URI.</p><p>For example:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// from("direct:insert").to("mongodb:myDb?database=flights&amp;collection=tickets&amp;operation=insert");</em>
Object result = template.requestBodyAndHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:insert"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"irrelevantBody"</em></strong>, MongoDbConstants.OPERATION_HEADER, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"count"</em></strong>);
assertTrue(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Result is not of type Long"</em></strong>, result <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">instanceof</strong> Long);</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_tailable_cursor_consumer"></a>Tailable Cursor Consumer</h2></div></div></div><p>MongoDB offers a mechanism to instantaneously consume ongoing data from
a collection, by keeping the cursor open just like the <code class="literal">tail -f</code> command
of *nix systems. This mechanism is significantly more efficient than a
scheduled poll, due to the fact that the server pushes new data to the
client as it becomes available, rather than making the client ping back
at scheduled intervals to fetch new data. It also reduces otherwise
redundant network traffic.</p><p>There is only one requisite to use tailable cursors: the collection must
be a "capped collection", meaning that it will only hold N objects, and
when the limit is reached, MongoDB flushes old objects in the same order
they were originally inserted. For more information, please refer to:
<a class="link" href="http://www.mongodb.org/display/DOCS/Tailable+Cursors" target="_top">http://www.mongodb.org/display/DOCS/Tailable+Cursors</a>.</p><p>The Camel MongoDB component implements a tailable cursor consumer,
making this feature available for you to use in your Camel routes. As
new objects are inserted, MongoDB will push them as DBObjects in natural
order to your tailable cursor consumer, who will transform them to an
Exchange and will trigger your route logic.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_the_tailable_cursor_consumer_works"></a>How the tailable cursor consumer works</h2></div></div></div><p>To turn a cursor into a tailable cursor, a few special flags are to be
signalled to MongoDB when first generating the cursor. Once created, the
cursor will then stay open and will block upon calling the
<code class="literal">DBCursor.next()</code> method until new data arrives. However, the MongoDB
server reserves itself the right to kill your cursor if new data doesn&#8217;t
appear after an indeterminate period. If you are interested to continue
consuming new data, you have to regenerate the cursor. And to do so, you
will have to remember the position where you left off or else you will
start consuming from the top again.</p><p>The Camel MongoDB tailable cursor consumer takes care of all these tasks
for you. You will just need to provide the key to some field in your
data of increasing nature, which will act as a marker to position your
cursor every time it is regenerated, e.g. a timestamp, a sequential ID,
etc. It can be of any datatype supported by MongoDB. Date, Strings and
Integers are found to work well. We call this mechanism "tail tracking"
in the context of this component.</p><p>The consumer will remember the last value of this field and whenever the
cursor is to be regenerated, it will run the query with a filter like:
<code class="literal">increasingField &gt; lastValue</code>, so that only unread data is consumed.</p><p><span class="strong"><strong>Setting the increasing field:</strong></span> Set the key of the increasing field on
the endpoint URI <code class="literal">tailTrackingIncreasingField</code> option. In Camel 2.10, it
must be a top-level field in your data, as nested navigation for this
field is not yet supported. That is, the "timestamp" field is okay, but
"nested.timestamp" will not work. Please open a ticket in the Camel JIRA
if you do require support for nested increasing fields.</p><p><span class="strong"><strong>Cursor regeneration delay:</strong></span> One thing to note is that if new data is
not already available upon initialisation, MongoDB will kill the cursor
instantly. Since we don&#8217;t want to overwhelm the server in this case, a
<code class="literal">cursorRegenerationDelay</code> option has been introduced (with a default
value of 1000ms.), which you can modify to suit your needs.</p><p>An example:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=cancellations&amp;tailTrackIncreasingField=departureTime"</em></strong>)
    .id(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"tailableCursorConsumer1"</em></strong>)
    .autoStartup(false)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:test"</em></strong>);</pre><p>The above route will consume from the "flights.cancellations" capped
collection, using "departureTime" as the increasing field, with a
default regeneration cursor delay of 1000ms.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_persistent_tail_tracking"></a>Persistent tail tracking</h2></div></div></div><p>Standard tail tracking is volatile and the last value is only kept in
memory. However, in practice you will need to restart your Camel
container every now and then, but your last value would then be lost and
your tailable cursor consumer would start consuming from the top again,
very likely sending duplicate records into your route.</p><p>To overcome this situation, you can enable the <span class="strong"><strong>persistent tail
tracking</strong></span> feature to keep track of the last consumed increasing value in
a special collection inside your MongoDB database too. When the consumer
initialises again, it will restore the last tracked value and continue
as if nothing happened.</p><p>The last read value is persisted on two occasions: every time the cursor
is regenerated and when the consumer shuts down. We may consider
persisting at regular intervals too in the future (flush every 5
seconds) for added robustness if the demand is there. To request this
feature, please open a ticket in the Camel JIRA.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_enabling_persistent_tail_tracking"></a>Enabling persistent tail tracking</h2></div></div></div><p>To enable this function, set at least the following options on the
endpoint URI:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">persistentTailTracking</code> option to <code class="literal">true</code></li><li class="listitem"><code class="literal">persistentId</code> option to a unique identifier for this consumer, so
that the same collection can be reused across many consumers</li></ul></div><p>Additionally, you can set the <code class="literal">tailTrackDb</code>, <code class="literal">tailTrackCollection</code> and
<code class="literal">tailTrackField</code> options to customise where the runtime information will
be stored. Refer to the endpoint options table at the top of this page
for descriptions of each option.</p><p>For example, the following route will consume from the
"flights.cancellations" capped collection, using "departureTime" as the
increasing field, with a default regeneration cursor delay of 1000ms,
with persistent tail tracking turned on, and persisting under the
"cancellationsTracker" id on the "flights.camelTailTracking", storing
the last processed value under the "lastTrackingValue" field
(<code class="literal">camelTailTracking</code> and <code class="literal">lastTrackingValue</code> are defaults).</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=cancellations&amp;tailTrackIncreasingField=departureTime&amp;persistentTailTracking=true"</em></strong> +
     <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;persistentId=cancellationsTracker"</em></strong>)
    .id(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"tailableCursorConsumer2"</em></strong>)
    .autoStartup(false)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:test"</em></strong>);</pre><p>Below is another example identical to the one above, but where the
persistent tail tracking runtime information will be stored under the
"trackers.camelTrackers" collection, in the "lastProcessedDepartureTime"
field:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb:myDb?database=flights&amp;collection=cancellations&amp;tailTrackIncreasingField=departureTime&amp;persistentTailTracking=true"</em></strong> +
     <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;persistentId=cancellationsTracker&amp;tailTrackDb=trackers&amp;tailTrackCollection=camelTrackers"</em></strong> +
     <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;tailTrackField=lastProcessedDepartureTime"</em></strong>)
    .id(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"tailableCursorConsumer3"</em></strong>)
    .autoStartup(false)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:test"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_oplog_tail_tracking"></a>Oplog Tail Tracking</h2></div></div></div><p>The <span class="strong"><strong>oplog</strong></span> collection tracking feature allows to implement trigger like functionality in MongoDB.
In order to activate this collection you will have first to activate a replica set. For more
information on this topic please check <a class="link" href="https://docs.mongodb.com/manual/tutorial/deploy-replica-set/" target="_top">https://docs.mongodb.com/manual/tutorial/deploy-replica-set/</a> .</p><p>Below you can find an example of a Java DSL based route demonstrating how you can use the component to track the <span class="strong"><strong>oplog</strong></span>
collection. In this specific case we are filtering the events which affect a collection <span class="strong"><strong>customers</strong></span> in
database <span class="strong"><strong>optlog_test</strong></span>. Note that the <code class="literal">tailTrackIncreasingField</code> is a timestamp field ('ts') which implies
that you have to use the <code class="literal">tailTrackingStrategy</code> parameter with the <span class="strong"><strong>TIMESTAMP</strong></span> value.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> com.mongodb.BasicDBObject;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> com.mongodb.MongoClient;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.Exchange;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.Message;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.Processor;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.builder.RouteBuilder;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.mongodb.MongoDBTailTrackingEnum;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.main.Main;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> java.io.InputStream;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: blue">/**
 * For this to work you need to turn on the replica set
 * &lt;p&gt;
 * Commands to create a replica set:
 * &lt;p&gt;
 * rs.initiate( {
 * _id : "rs0",
 * members: [ { _id : 0, host : "localhost:27017" } ]
 * })
 */</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong> MongoDbTracker {

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">final</strong> String database;

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">final</strong> String collection;

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">final</strong> String increasingField;

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> MongoDBTailTrackingEnum trackingStrategy;

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">int</strong> persistRecords = -<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>;

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">boolean</strong> persistenTailTracking;

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> MongoDbTracker(String database, String collection, String increasingField) {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">this</strong>.database = database;
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">this</strong>.collection = collection;
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">this</strong>.increasingField = increasingField;
    }

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">static</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> main(String[] args) <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">final</strong> MongoDbTracker mongoDbTracker = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MongoDbTracker(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"local"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"oplog.rs"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ts"</em></strong>);
        mongoDbTracker.setTrackingStrategy(MongoDBTailTrackingEnum.TIMESTAMP);
        mongoDbTracker.setPersistRecords(<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">5</span>);
        mongoDbTracker.setPersistenTailTracking(true);
        mongoDbTracker.startRouter();
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// run until you terminate the JVM</em>
        System.out.println(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Starting Camel. Use ctrl + c to terminate the JVM.\n"</em></strong>);

    }

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> setTrackingStrategy(MongoDBTailTrackingEnum trackingStrategy) {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">this</strong>.trackingStrategy = trackingStrategy;
    }

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> setPersistRecords(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">int</strong> persistRecords) {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">this</strong>.persistRecords = persistRecords;
    }

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> setPersistenTailTracking(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">boolean</strong> persistenTailTracking) {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">this</strong>.persistenTailTracking = persistenTailTracking;
    }

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> startRouter() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// create a Main instance</em>
        Main main = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Main();
        main.bind(MongoConstants.CONN_NAME, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MongoClient(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"localhost"</em></strong>, <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">27017</span>));
        main.addRouteBuilder(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> RouteBuilder() {
            <em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> configure() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
                getContext().getTypeConverterRegistry().addTypeConverter(InputStream.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>, BasicDBObject.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>,
                        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MongoToInputStreamConverter());
                from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mongodb://"</em></strong> + MongoConstants.CONN_NAME + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"?database="</em></strong> + database
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;collection="</em></strong> + collection
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;persistentTailTracking="</em></strong> + persistenTailTracking
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;persistentId=trackerName"</em></strong> + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;tailTrackDb=local"</em></strong>
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;tailTrackCollection=talendTailTracking"</em></strong>
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;tailTrackField=lastTrackingValue"</em></strong>
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;tailTrackIncreasingField="</em></strong> + increasingField
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;tailTrackingStrategy="</em></strong> + trackingStrategy.toString()
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;persistRecords="</em></strong> + persistRecords
                        + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;cursorRegenerationDelay=1000"</em></strong>)
                        .filter().jsonpath(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"$[?(@.ns=='optlog_test.customers')]"</em></strong>)
                        .id(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"logger"</em></strong>)
                        .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"log:logger?level=WARN"</em></strong>)
                        .process(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Processor() {
                            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> process(Exchange exchange) <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
                                Message message = exchange.getIn();
                                System.out.println(message.getBody().toString());
                                exchange.getOut().setBody(message.getBody().toString());
                            }
                        });
            }
        });
        main.run();
    }
}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_type_conversions"></a>Type conversions</h2></div></div></div><p>The <code class="literal">MongoDbBasicConverters</code> type converter included with the
camel-mongodb component provides the following conversions:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">From type</th><th align="left" valign="top">To type</th><th align="left" valign="top">How?</th></tr></thead><tbody><tr><td align="left" valign="top"><p>fromMapToDBObject</p></td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p><code class="literal">DBObject</code></p></td><td align="left" valign="top"><p>constructs a new <code class="literal">BasicDBObject</code> via the <code class="literal">new BasicDBObject(Map m)</code>
constructor</p></td></tr><tr><td align="left" valign="top"><p>fromBasicDBObjectToMap</p></td><td align="left" valign="top"><p><code class="literal">BasicDBObject</code></p></td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p><code class="literal">BasicDBObject</code> already implements <code class="literal">Map</code></p></td></tr><tr><td align="left" valign="top"><p>fromStringToDBObject</p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p><code class="literal">DBObject</code></p></td><td align="left" valign="top"><p>uses <code class="literal">com.mongodb.util.JSON.parse(String s)</code></p></td></tr><tr><td align="left" valign="top"><p>fromAnyObjectToDBObject</p></td><td align="left" valign="top"><p><code class="literal">Object</code>&nbsp;</p></td><td align="left" valign="top"><p><code class="literal">DBObject</code></p></td><td align="left" valign="top"><p>uses the <a class="link" href="http://jackson.codehaus.org/" target="_top">Jackson library</a> to convert the
object to a <code class="literal">Map</code>, which is in turn used to initialise a new
<code class="literal">BasicDBObject</code></p></td></tr></tbody></table></div><p>This type converter is auto-discovered, so you don&#8217;t need to configure
anything manually.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_see_also_78"></a>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="http://www.mongodb.org/" target="_top">MongoDB website</a></li><li class="listitem"><a class="link" href="http://en.wikipedia.org/wiki/NoSQL" target="_top">NoSQL Wikipedia article</a></li><li class="listitem"><a class="link" href="http://api.mongodb.org/java/current/" target="_top">MongoDB Java driver API docs -
current version</a>
*
<a class="link" href="https://github.com/apache/camel/tree/master/components/camel-mongodb/src/test" target="_top">Unit
tests</a> for more examples of usage</li></ul></div></div></div></body></html>