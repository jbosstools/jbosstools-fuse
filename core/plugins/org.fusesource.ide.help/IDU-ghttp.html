<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>ghttp</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-GAE.html" title="GAE"><link rel="prev" href="IDU-gauth.html" title="gauth"><link rel="next" href="IDU-glogin.html" title="glogin"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-ghttp"></a>ghttp</h2></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_ghttpComponent"></a>ghttp Component</h3></div></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>The GAE components are deprecated and will be removed from a future release of
                JBoss Fuse.</p></td></tr></table></div><p>The <code class="literal">ghttp</code> component contributes to the <a href="IDU-GAE.html" class="olink">Camel Components for Google App Engine</a> (GAE). It provides connectivity to the GAE
        <a class="link" href="http://code.google.com/appengine/docs/java/urlfetch/" target="_top">URL fetch
        service</a> but can also be used to receive messages from servlets (the only way to
      receive HTTP requests on GAE). This is achieved by extending the 
        <a href="IDU-SERVLET.html" class="olink">Servlet component</a>. As a consequence,
        <code class="literal">ghttp</code> URI formats and options sets differ on the consumer-side
        (<code class="literal">from</code>) and producer-side (<code class="literal">to</code>). </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_URIformat"></a>URI format</h3></div></div></div><table id="d0e88438"><tr>
        <th>Format</th>
        <th>Context</th>
        <th>Comment</th>
      </tr><tr>
        <td>
          <pre class="programlisting">ghttp:///path[?options]</pre>
        </td>
        <td>Consumer</td>
        <td>See also <a href="IDU-SERVLET.html" class="olink">Servlet component</a>
        </td>
      </tr><tr>
        <td>
          <pre class="programlisting">ghttp://hostname[:port][/path][?options]
ghttps://hostname[:port][/path][?options]</pre>
        </td>
        <td>Producer</td>
        <td>See also <a href="IDU-HTTP.html" class="olink">Http component</a>
        </td>
      </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_Options"></a>Options</h3></div></div></div><table id="d0e88488"><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Context </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">bridgeEndpoint</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td> Producer </td>
        <td>If set to <code class="literal">true</code> the <code class="literal">Exchange.HTTP_URI</code> header will
          be ignored. To override the default endpoint URI with the
            <code class="literal">Exchange.HTTP_URI</code> header set this option to
          <code class="literal">false</code>.</td>
      </tr><tr>
        <td><code class="literal">throwExceptionOnFailure</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td> Producer </td>
        <td>Throw a <code class="literal">org.apache.camel.component.gae.http</code> if the response code is
          &gt;= 400. To disable throwing an exception set this option to <code class="literal">false</code>.</td>
      </tr><tr>
        <td><code class="literal">inboundBindingRef</code>
        </td>
        <td> reference to <code class="literal">GHttpBinding</code>
        </td>
        <td> Consumer </td>
        <td>Reference to an <code class="literal">InboundBinding&lt;GHttpEndpoint, HttpServletRequest,
            HttpServletResponse&gt;</code> in the Registry for
          customizing the binding of an <code class="literal">Exchange</code> to the Servlet API. The
          referenced binding is used as post-processor to
            <code class="literal">org.apache.camel.component.http.HttpBinding</code>.</td>
      </tr><tr>
        <td><code class="literal">outboundBindingRef</code>
        </td>
        <td> reference to <code class="literal">GHttpBinding</code>
        </td>
        <td> Producer </td>
        <td>Reference to an <code class="literal">OutboundBinding&lt;GHttpEndpoint, HTTPRequest,
            HTTPResponse&gt;</code> in the Registry for customizing
          the binding of an <code class="literal">Exchange</code> to the
          <code class="literal">URLFetchService</code>.</td>
      </tr></table><p>On the consumer-side, all options of the <a href="IDU-SERVLET.html" class="olink">Servlet
        component</a> are supported.</p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_Messageheaders"></a>Message headers</h3></div></div></div><p>On the producer side, the following headers of the <a href="IDU-HTTP.html" class="olink">Http
        component</a> are supported.</p><table id="d0e88627"><tr>
        <th> Name </th>
        <th> Type </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">Exchange.CONTENT_TYPE</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td>The HTTP content type. Is set on both the <code class="literal">in</code> and
            <code class="literal">out</code> message to provide a content type, such as
            <code class="literal">text/html</code>. </td>
      </tr><tr>
        <td><code class="literal">Exchange.CONTENT_ENCODING</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td>The HTTP content encoding. Is set on both the <code class="literal">in</code> and
            <code class="literal">out</code> message to provide a content encoding, such as
            <code class="literal">gzip</code>.</td>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_METHOD</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td>The HTTP method to execute. One of <code class="literal">GET</code>, <code class="literal">POST</code>,
            <code class="literal">PUT</code> and <code class="literal">DELETE</code>. If not set,
            <code class="literal">POST</code> will be used if the message body is not <code class="literal">null</code>,
            <code class="literal">GET</code> otherwise.</td>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_QUERY</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td>Overrides the query part of the endpoint URI or the the query part of
            <code class="literal">Exchange.HTTP_URI</code> (if defined). The query string must be in decoded
          form.</td>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_URI</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td>Overrides the default endpoint URI if the <code class="literal">bridgeEndpoint</code> option is
          set to <code class="literal">false</code>. The URI string must be in decoded form.</td>
      </tr><tr>
        <td><code class="literal">Exchange.RESPONSE_CODE</code>
        </td>
        <td><code class="literal">int</code>
        </td>
        <td>The HTTP response code from URL fetch service responses.</td>
      </tr></table><p>On the consumer-side all headers of the <a href="IDU-SERVLET.html" class="olink">Servlet
        component</a> component are supported.</p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_Messagebody"></a>Message body</h3></div></div></div><p>On the producer side the <code class="literal">in</code> message body is converted to a
        <code class="literal">byte[]</code>. The <code class="literal">out</code> message body is made available as
        <code class="literal">InputStream</code>. If the reponse size exceeds 1 megabyte a <a class="link" href="http://code.google.com/appengine/docs/java/javadoc/" target="_top">ResponseTooLargeException</a> is thrown by the URL fetch service (see <a class="link" href="http://code.google.com/appengine/docs/java/urlfetch/overview.html#Quotas_and_Limits" target="_top">quotas and limits</a>).</p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_Receivingmessages"></a>Receiving messages</h3></div></div></div><p>For receiving messages via the <code class="literal">ghttp</code> component, a
        <code class="literal">CamelHttpTransportServlet</code> must be configured and mapped in the
      application's <code class="literal">web.xml</code> (see <a href="bk05ch58s01.html#IDU-GAE_HSH_Thewebxml" class="olink">The web.xml</a>). For example, to handle requests targeted at
        <code class="literal">http://&lt;appname&gt;.appspot.com/camel/*</code> or
        <code class="literal">http://localhost/camel/*</code> (when using a local development server) the
      following servlet mapping must be defined:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: web.xml"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">web.xml</th></tr><tr><td align="left" valign="top"><pre class="programlisting">    ...
    &lt;servlet&gt;
        &lt;servlet-name&gt;CamelServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;org.apache.camel.component.servlet.CamelHttpTransportServlet&lt;/servlet-class&gt;
        ...
    &lt;/servlet&gt;
    ...
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;CamelServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/camel/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
    ...</pre></td></tr></table></div><p>Endpoint URI path definitions are relative to this servlet mapping e.g. the route</p><pre class="programlisting">from("ghttp:///greeting").transform().constant("Hello")</pre><p>processes requests targeted at <code class="literal">
        <a class="link" href="http://<appname&gt;.appspot.com/camel/greeting" target="_top">http://&lt;appname&gt;.appspot.com/camel/greeting</a></code>. In this example, the
      request body is ignored and the response body is set to <code class="literal">Hello</code>. Requests
      targeted at <code class="literal">http://&lt;appname&gt;.appspot.com/camel/greeting/*</code> are not
      processed by default. This requires setting the option <code class="literal">matchOnUriPrefix</code> to
        <code class="literal">true</code>.</p><pre class="programlisting">from("ghttp:///greeting?matchOnUriPrefix=true").transform().constant("Hello")</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_Sendingmessages"></a>Sending messages</h3></div></div></div><p>For sending resquests to external HTTP services the <code class="literal">ghttp</code> component
      uses the <a class="link" href="http://code.google.com/appengine/docs/java/urlfetch/" target="_top">URL fetch
        service</a>. For example, the Apache Camel homepage can the retrieved with the following
      endpoint definition on the producer-side.</p><pre class="programlisting">from(...)
...
.to("ghttp://camel.apache.org")
...</pre><p>The HTTP method used depends on the <code class="literal">Exchange.HTTP_METHOD</code> message header
      or on the presence of an in-message body (<code class="literal">GET</code> if <code class="literal">null</code>,
        <code class="literal">POST</code> otherwise). Retrieving the Camel homepage via a GAE application is
      as simple as</p><pre class="programlisting">from("ghttp:///home")
.to("ghttp://camel.apache.org")</pre><p>Sending a <code class="literal">GET</code> request to <code class="literal">
        <a class="link" href="http://<appname&gt;.appspot.com/camel/home" target="_top">http://&lt;appname&gt;.appspot.com/camel/home</a></code> returns the Camel homepage.
      HTTPS-based communication with external services can be enabled with the
        <code class="literal">ghttps</code> scheme.</p><pre class="programlisting">from(...)
...
.to("ghttps://svn.apache.org/repos/asf/camel/trunk/")
...</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="IDU-ghttp_HSH_Dependencies"></a>Dependencies</h3></div></div></div><p>Maven users will need to add the following dependency to their
      <code class="literal">pom.xml</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: pom.xml"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">pom.xml</th></tr><tr><td align="left" valign="top"><pre class="programlisting">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-gae&lt;/artifactId&gt;
    &lt;version&gt;${camel-version}&lt;/version&gt;
&lt;/dependency&gt;</pre></td></tr></table></div><p>where <code class="literal">${camel-version}</code> must be replaced by the actual version of Apache Camel
      (2.1.0 or higher).</p></div></div></body></html>