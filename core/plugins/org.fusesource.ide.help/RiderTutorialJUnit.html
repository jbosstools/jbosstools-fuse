<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>To Test a Route with JUnit</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="description" content="This tutorial shows you how to use the New Camel Test Case wizard to create a test case for your route and then test the route."><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="RiderTutorials.html" title="Tutorials"><link rel="prev" href="RiderTutorialTrace.html" title="To Trace a Message Through a Route"><link rel="next" href="RiderTutDeployFESB.html" title="To Publish a Fuse Project to Red Hat JBoss Fuse"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="RiderTutorialJUnit"></a>To Test a Route with JUnit</h1></div><div><div class="abstract"><p>This tutorial shows you how to use the <span class="guilabel">New Camel Test Case</span>
                wizard to create a test case for your route and then test the route.</p></div></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e24843"></a>Overview</h2></div></div></div><p>The <span class="guilabel">New Camel Test Case</span> wizard generates a boilerplate JUnit test
            case. When you create or modify a route (for example, adding more processors to it), you
            create or modify the generated test case to add expectations and assertions specific to
            the route you created or updated.This ensures that the test is valid for the
            route.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e24851"></a>Goals</h2></div></div></div><p>In this tutorial you will:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Create the <code class="filename">/src/test/</code> folder to store the JUnit test case </p></li><li class="listitem"><p>Generate the JUnit test case for the <span class="guilabel">CBRroute</span>
                    project</p></li><li class="listitem"><p>Modify the newly generated JUnit test case</p></li><li class="listitem"><p>Modify the <span class="guilabel">CBRroute</span> project's
                        <code class="filename">pom.xml</code> file</p></li><li class="listitem"><p>Run the <span class="guilabel">CBRroute</span> with the new JUnit test case</p></li><li class="listitem"><p>Observe the output</p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e24890"></a>Prerequisites</h2></div></div></div><p>To complete this tutorial you need the <span class="bold"><strong>CBRroute</strong></span>
            project you used in <a href="RiderTutorialTrace.html" class="olink"><i>To Trace a Message Through a Route</i></a></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you skipped any tutorial after <a href="RiderTutorialCreate.html" class="olink"><i>To Create a New Route</i></a>, you can use the
                prefabricated <code class="filename">blueprintContext6.xml</code> file to work through this
                tutorial (for details, see <a href="RiderTutorialResources.html" class="olink"><i>Using the Fuse Tooling Resource Files</i></a>).</p></td></tr></table></div><p>Delete any trace-generated messages from the
                <span class="guilabel">CBRroute</span> project's
                <code class="filename">/src/data/</code> directory and
                <code class="filename">/target/messages/</code> subdirectories in
                <span class="guilabel">Project Explorer</span>. Trace-generated messages
            begin with the <code class="literal">ID-</code> prefix. For example, <a class="xref" href="RiderTutorialJUnit.html#tutTraceMsgExample" title="Figure&nbsp;5.&nbsp;Trace-generated messages">Figure&nbsp;5, &#8220;Trace-generated messages&#8221;</a> shows six trace-generated
            messages:</p><div class="figure"><a name="tutTraceMsgExample"></a><p class="title"><b>Figure&nbsp;5.&nbsp;Trace-generated messages</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/tutTraceGenMsgs.png" width="147.7" alt="Trace-generated messages"></div></div></div><br class="figure-break"><p>Select all trace-generated messages in batch, right-click to open the
            context menu, and select <span class="guimenuitem">Delete</span>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e24939"></a>Creating the <code class="filename">src/test</code> folder</h2></div></div></div><p>Before you create a JUnit test case for the <span class="guilabel">CBRroute</span> project, you
            must create a folder for it that is included in the build path:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>In <span class="guilabel">Project Explorer</span>, right-click the
                        <span class="guilabel">CBRroute</span> project's root to open the context menu, and
                    then select <span class="guimenu">New</span> &gt; <span class="guimenuitem">Folder</span>.</p></li><li class="step"><p>In the 
                        <span class="guilabel">New Folder</span>
                     dialog, in the project tree pane, expand the
                        <code class="literal">CBRroute</code> node and select the <code class="filename">src</code>
                    folder.</p><p>Make sure <code class="literal">CBRroute/src</code> appears in the <span class="guilabel">Enter or
                    select the parent folder</span>
                    field.</p></li><li class="step"><p>In <span class="guilabel">Folder name</span>, enter
                    <strong class="userinput"><code>/test/java</code></strong>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCreateJUnitTestFolder.png" width="232.2"></div></div></li><li class="step"><p>Click <span class="guibutton">Finish</span>.</p><p>In <span class="guilabel">Project Explorer</span>, the new
                        <code class="filename">src/test/java</code> folder appears under the
                        <code class="filename">src/main/resources</code> folder:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutTestFolderAdded.png" width="217.79999999999998"></div></div></li><li class="step"><p>Verify that the new <code class="filename">/src/test/java</code> folder is included in
                    the build path.</p><ol type="a" class="substeps"><li class="step"><p>In <span class="guilabel">Project Explorer</span>, right-click the <code class="filename">/src/test/java</code>
                            folder to open the context menu.</p></li><li class="step"><p>Select <span class="guisubmenu">Build Path </span> to see the menu options:</p><p>The menu option <span class="guimenuitem">Remove from Build Path</span> verifies
                            that the <code class="filename">/src/test/java</code> folder is currently
                            included in the build path:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutJavaFolderOnBldPath.png" width="192.6"></div></div></li></ol></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e25054"></a>Creating the JUnit test case</h2></div></div></div><p>To create a JUnit test case for the <span class="guilabel">CBRroute</span> project:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>In <span class="guilabel">Project Explorer</span>, select
                        <code class="filename">src/test/java</code>.</p></li><li class="step"><p>Right-click it to open the context menu, and then select <span class="guimenu">New</span> &gt; <span class="guimenuitem">Camel Test Case</span>:</p><div class="informalfigure"><div class="mediaobject"><img src="images/NewCamTstCaseTut.png" width="358.8"></div></div></li><li class="step"><p>In the <span class="guilabel">Camel JUnit Test Case</span> wizard, make sure the
                        <span class="guilabel">Source folder</span> field contains
                        <strong class="userinput"><code>CBRroute/src/test/java</code></strong>. To find the proper folder,
                    click <span class="inlinemediaobject"><img src="images/BrowseButton.jpg" alt="browse button"></span> .</p></li><li class="step"><p>In the <span class="guilabel">Package</span> field, enter
                        <strong class="userinput"><code>tutorial.cbr.route</code></strong>. This is the package that will
                    include the new test case.</p></li><li class="step"><p>Next to the <span class="guilabel">Camel XML file under test</span> field,  click
                        <span class="guibutton">Browse</span> to open a file explorer configured to screen
                    for XML files, and then select the <span class="guilabel">CBRroute</span> project's
                        <code class="filename">blueprint.xml</code> file:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutCamXMLUnderTst.png" width="292.2"></div></div></li><li class="step"><p>Click <span class="guibutton">OK</span>.</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutCamJUnitTstPgComplete.png" width="337.8"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The <span class="guilabel">Name</span> field defaults to
                            <em class="replaceable"><code>BlueprintXmlTest</code></em>.</p></td></tr></table></div></li><li class="step"><p>Click <span class="guibutton">Next</span> to open the <span class="guilabel">Test
                        Endpoints</span> page.</p></li><li class="step"><p>By default, all endpoints are selected and will be included in the test case.
                    Click <span class="guibutton">Finish</span>.
                    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If prompted, add JUnit to the build path.</p></td></tr></table></div></li></ol></div><p>The artifacts for the test are added to your project and appear in
                <span class="guilabel">Project Explorer</span> under
            <code class="filename">src/test/java</code>. The
            class implementing the test case opens in the tooling's Java
            editor:</p><div class="informalexample"><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">package</strong> tutorial.cbr.route;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.EndpointInject;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.Produce;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.ProducerTemplate;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.builder.RouteBuilder;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.mock.MockEndpoint;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.test.blueprint.CamelBlueprintTestSupport;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.junit.Test;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong> BlueprintXmlTest <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">extends</strong> CamelBlueprintTestSupport {

	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// TODO Create test message bodies that work for the route(s) being tested</em>
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Expected message bodies</em>
	
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> object[] expectBodies = {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;something id='1'&gt;expectedBody1&lt;/something&gt;"</em></strong>, 
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;something id='2'&gt;expectedBody2&lt;/something&gt;"</em></strong>;
	
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Templates to send to input endpoints</em>
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Produce(uri = "file:src/data?noop=true")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> ProducerTemplate inputEndpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Produce(uri = "direct:OrderFulfillment")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> ProducerTemplate input2Endpoint;
	
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Mock endpoints used to consume messages from the output endpoints and </em>
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// then perform assertions</em>
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint outputEndpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output2")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output2Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output3")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output3Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output4")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output4Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output5")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output5Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output6")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output6Endpoint;

	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Test</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> testCamelRoute() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Create routes from the output endpoints to our mock endpoints so we can </em>
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// assert expectations</em>
		context.addRoutes(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> RouteBuilder() {
			<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
			<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> configure() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/invalidOrders"</em></strong>).to(outputEndpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/GreatBritain"</em></strong>).to(output3Endpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/Germany"</em></strong>).to(output4Endpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/USA"</em></strong>).to(output2Endpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/France"</em></strong>).to(output5Endpoint);
			}
		});

		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Define some expectations</em>

		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// TODO Ensure expectations make sense for the route(s) we're testing</em>
		outputEndpoint.expectedBodiesReceivedInAnyOrder(expectedBodies);

		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Send some messages to input endpoints</em>
		<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">for</strong> (Object expectedBody : expectedBodies) {
			inputEndpoint.sendBody(expectedBody);
		}

		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Validate our expectations</em>
		assertMockEndpointsSatisfied();
	}

	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String getBlueprintDescriptor() {
		<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">return</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"OSGI-INF/blueprint/blueprint.xml"</em></strong>;
	}

}</pre></div><p>This generated JUnit test case is insufficient for the <span class="guilabel">CBRroute</span>
            project, and it will fail to run successfully. You need to modify it and the project's
                <code class="filename">pom.xml</code>, as described in <a class="xref" href="RiderTutorialJUnit.html#modifyCamContext" title="Modifying the BlueprintXmlTest file">Modifying the BlueprintXmlTest file </a> and
                <a class="xref" href="RiderTutorialJUnit.html#modifyPomXml" title="Modifying the pom.xml file">Modifying the pom.xml file</a>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="modifyCamContext"></a>Modifying the BlueprintXmlTest file </h2></div></div></div><p>You must modify the <code class="filename">BlueprintXmlTest.java</code> file to: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Import several classes that support required file functions</p></li><li class="listitem"><p>Create variables for holding the content of the various source
                            <code class="filename">.xml</code> files</p></li><li class="listitem"><p>Read the content of the source <code class="filename">.xml</code> files</p></li><li class="listitem"><p>Define appropriate expectations</p></li></ul></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>In <span class="guilabel">Project Explorer</span>, expand the <span class="guilabel">CBRroute</span> project to
                    expose the <code class="filename">BlueprintXmlTest.java</code> file:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutBlueprintXMLTestProjExp.png" width="179.4"></div></div></li><li class="step"><p>Double-click <code class="filename">BlueprintXmlTest.java</code> to open the file in the tooling's Java
                    editor.</p></li><li class="step"><p>In the Java editor, click the expand button next to <code class="code">import
                        org.apache.camel.EndpointInject;</code> to expand the list.</p></li><li class="step"><p>Add the two lines shown below. Adding the first line will cause an error that will be resolved
                    when you update the <code class="filename">pom.xml</code> file as instructed in the next
                    section. </p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutBPTstImportFileUtils.png" width="281.05"></div></div></li><li class="step"><p>Scroll down to the lines that follow directly after <code class="code">// Expected
                        message bodies</code>. </p></li><li class="step"><p>Replace those lines&#8212;<code class="code">protected Object[] expectedBodies={ ......
                        expectedBody2&lt;/something&gt;"};</code>&#8212; with the
                    <code class="code">protected String body#;</code> lines shown here:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCamCntxtFile2.png" width="540.8"></div></div></li><li class="step"><p>Scroll down to the line <code class="code">public void testCamelRoute() throws Exception {</code>, and
                    insert directly after it the lines <code class="code">body# = FileUtils.readFileToString(new
                        File("src/data/message#.xml"), "UTF-8");</code> shown below. These lines
                    will indicate an error until you update the <code class="filename">pom.xml </code>file as
                    instructed in the next section. </p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCamCntxtFile3.png" width="382.2"></div></div></li><li class="step"><p>Scroll down to the lines that follow directly after
                <code class="code">// TODO Ensure
                    expectations make sense for the route(s) we're
                    testing</code>.</p></li><li class="step"><p>Replace the block of code that begins with
                        <code class="code">outputEndpoint.expectedBodiesReceivedInAnyOrder(expectedBodies);</code>
                    and ends with ...<code class="code">inputEndpoint.sendBody(expectedBody); }</code> with the
                    lines shown here:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCamCntxtFile4.png" width="346.45"></div></div><p>Leave the remaining code as is.</p></li><li class="step"><p>Save the file.</p></li><li class="step"><p>Check that your updated <code class="filename">BlueprintXmlTest.java</code> file has the required
                    modifications. It should look something like this:</p><div class="informalexample"><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">package</strong> tutorial.cbr.route;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.EndpointInject;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.Produce;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.ProducerTemplate;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.builder.RouteBuilder;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.mock.MockEndpoint;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.test.blueprint.CamelBlueprintTestSupport;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.commons.io.FileUtils;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.junit.Test;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> java.io.File;

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong> BlueprintXmlTest <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">extends</strong> CamelBlueprintTestSupport {

	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// TODO Create test message bodies that work for the route(s) being tested</em>
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Expected message bodies</em>
	
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// To assert that everything works as it should, you must read </em>
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// the content of the created xml files</em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String body1;
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String body2;
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String body3;
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String body4;
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String body5;
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String body6;
	
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Templates to send to input endpoints</em>
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Produce(uri = "file:src/data?noop=true")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> ProducerTemplate inputEndpoint;
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Mock endpoints used to consume messages from the output endpoints </em>
	<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// and then perform assertions</em>
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint outputEndpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output2")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output2Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output3")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output3Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output4")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output4Endpoint;
	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@EndpointInject(uri = "mock:output5")</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> MockEndpoint output5Endpoint;

	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Test</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> testCamelRoute() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Easy way of reading content of xml files to String object, but you must </em>
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// add a dependency to the commons-io project to the CBRroute pom.xml file</em>
		body1 = FileUtils.readFileToString(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"src/data/message1.xml"</em></strong>), <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>);
		body3 = FileUtils.readFileToString(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"src/data/message3.xml"</em></strong>), <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>);
		body5 = FileUtils.readFileToString(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"src/data/message5.xml"</em></strong>), <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>);
		body6 = FileUtils.readFileToString(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"src/data/message6.xml"</em></strong>), <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>);
		
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Invalid Orders</em>
		body2 = FileUtils.readFileToString(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"src/data/message2.xml"</em></strong>), <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>);		
		body4 = FileUtils.readFileToString(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"src/data/message4.xml"</em></strong>), <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>);		
		
		context.addRoutes(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> RouteBuilder() {
			<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
			<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> configure() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/invalidOrders"</em></strong>).to(outputEndpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/GreatBritain"</em></strong>).to(output3Endpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/Germany"</em></strong>).to(output4Endpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/USA"</em></strong>).to(output2Endpoint);
				from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/messages/France"</em></strong>).to(output5Endpoint);
			}
		});

		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Define some expectations</em>

		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// TODO Ensure expectations make sense for the route(s) we're testing</em>
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Invalid Orders</em>
		outputEndpoint.expectedBodiesReceived(body2, body4);
		
		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//For each country, one order</em>
		output2Endpoint.expectedBodiesReceived(body1);
		output3Endpoint.expectedBodiesReceived(body3);
		output4Endpoint.expectedBodiesReceived(body6);
		output5Endpoint.expectedBodiesReceived(body5);


		<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Validate our expectations</em>
		assertMockEndpointsSatisfied();
	}

	<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
	<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> String getBlueprintDescriptor() {
		<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">return</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"OSGI-INF/blueprint/blueprint.xml"</em></strong>;
	}

}</pre></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="modifyPomXml"></a>Modifying the pom.xml file</h2></div></div></div><p>You need to add a dependency on the <code class="literal">commons-io</code> project to the
            CBRroute project's <code class="filename">pom.xml</code> file:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>In <span class="guilabel">Project Explorer</span>, double-click <code class="filename">pom.xml</code>, located
                    below the <code class="filename">target</code> folder, to open the file in the tooling's
                    XML editor.</p></li><li class="step"><p>Click the <span class="guilabel">pom.xml</span> tab at the bottom of the page to open the file for
                    editing.</p></li><li class="step"><p>Add these lines to the end of the
                <code class="code">&lt;dependencies&gt;</code> section:</p><div class="informalexample"><pre class="programlisting">&lt;dependency&gt;
       &lt;groupId&gt;commons-io&lt;/groupId&gt;
       &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
       &lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2.5</span>&lt;/version&gt;
       &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div></li><li class="step"><p>Save the file.</p><p>The contents of the entire <code class="filename">pom.xml</code>
                    file should look like this:</p><div class="informalexample"><pre class="programlisting">&lt;?xml version=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"1.0"</em></strong> encoding=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"UTF-8"</em></strong>?&gt;

&lt;project xsi:schemaLocation=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://maven.apache.org/POM/4.0.0 
</em></strong>  http:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//maven.apache.org/xsd/maven-4.0.0.xsd" </em>
  xmlns=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://maven.apache.org/POM/4.0.0"</em></strong>
  xmlns:xsi=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://www.w3.org/2001/XMLSchema-instance"</em></strong>&gt;
  
  &lt;modelVersion&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">4.0</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span>&lt;/modelVersion&gt;
  &lt;groupId&gt;co&lt;/groupId&gt;
  &lt;artifactId&gt;camel-blueprint&lt;/artifactId&gt;
  &lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1.0</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span>-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;bundle&lt;/packaging&gt;
  &lt;name&gt;Camel Blueprint Quickstart&lt;/name&gt;
  &lt;description&gt;Empty Camel Blueprint Example&lt;/description&gt;
  
  &lt;licenses&gt;
    &lt;license&gt;
      &lt;name&gt;Apache License, Version <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2.0</span>&lt;/name&gt;
      &lt;url&gt;http:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//www.apache.org/licenses/LICENSE-2.0.html&lt;/url&gt;</em>
      &lt;distribution&gt;repo&lt;/distribution&gt;
    &lt;/license&gt;
  &lt;/licenses&gt;
  
  &lt;properties&gt;
    &lt;camel.version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2.18</span>.1.redhat-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">000015</span>&lt;/camel.version&gt;
    &lt;project.reporting.outputEncoding&gt;UTF-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">8</span>&lt;/project.reporting.outputEncoding&gt;
    &lt;version.maven-bundle-plugin&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2.3</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">7</span>&lt;&lt;/version.maven-bundle-plugin&gt;
    &lt;jboss.fuse.bom.version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">6.3</span>.0.redhat-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">187</span>&lt;/jboss.fuse.bom.version&gt;
    &lt;project.build.sourceEncoding&gt;UTF-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">8</span>&lt;/project.build.sourceEncoding&gt;
  &lt;/properties&gt;
  
  &lt;dependencyManagement&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.jboss.fuse.bom&lt;/groupId&gt;
        &lt;artifactId&gt;jboss-fuse-parent&lt;/artifactId&gt;
        &lt;version&gt;${jboss.fuse.bom.version}&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong>&lt;/scope&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;
  
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
      &lt;artifactId&gt;camel-core&lt;/artifactId&gt;
      &lt;version&gt;${camel.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
      &lt;artifactId&gt;camel-blueprint&lt;/artifactId&gt;
      &lt;version&gt;${camel.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;log4j&lt;/groupId&gt;
      &lt;artifactId&gt;log4j&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
      &lt;artifactId&gt;camel-test-blueprint&lt;/artifactId&gt;
      &lt;version&gt;${camel.version}&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;commons-io&lt;/groupId&gt;
      &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
      &lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2.5</span>&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
        &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;id&gt;fuse-<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong>-repository&lt;/id&gt;
      &lt;name&gt;FuseSource Community Release Repository&lt;/name&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//repo.fusesource.com/nexus/content/groups/public&lt;/url&gt;</em>
    &lt;/repository&gt;
    &lt;repository&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
        &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;id&gt;red-hat-ga-repository&lt;/id&gt;
      &lt;name&gt;Red Hat GA Repository&lt;/name&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//maven.repository.redhat.com/ga&lt;/url&gt;</em>
    &lt;/repository&gt;
    &lt;repository&gt;
      &lt;id&gt;fuse-ea&lt;/id&gt;
      &lt;url&gt;http:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//download.eng.brq.redhat.com/brewroot/repos/jb-fuse-6.2-build/latest/maven&lt;/url&gt;</em>
    &lt;/repository&gt;
    &lt;repository&gt;
      &lt;id&gt;redhat-ea-repository&lt;/id&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//maven.repository.redhat.com/earlyaccess/all&lt;/url&gt;</em>
    &lt;/repository&gt;
  &lt;/repositories&gt;
  
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
        &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;id&gt;fuse-<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong>-repository&lt;/id&gt;
      &lt;name&gt;FuseSource Community Release Repository&lt;/name&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//repo.fusesource.com/nexus/content/groups/public&lt;/url&gt;</em>
    &lt;/pluginRepository&gt;
    &lt;pluginRepository&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
        &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;id&gt;red-hat-ga-repository&lt;/id&gt;
      &lt;name&gt;Red Hat GA Repository&lt;/name&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//maven.repository.redhat.com/ga&lt;url&gt;</em>
    &lt;/pluginRepository&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;fuse-ea&lt;/id&gt;
      &lt;url&gt;http:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//download.eng.brq.redhat.com/brewroot/repos/jb-fuse-6.2-build/latest/maven&lt;/url&gt;</em>
    &lt;/pluginRepository&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;redhat-ea-repository&lt;/id&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//maven.repository.redhat.com/earlyaccess/all&lt;/url&gt;</em>
    &lt;/pluginRepository&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;camelStaging&lt;/id&gt;
      &lt;url&gt;https:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//repository.jboss.org/nexus/content/repositories/fusesource_releases_external-2384&lt;/url&gt;</em>
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;
  
  &lt;build&gt;
    &lt;defaultGoal&gt;install&lt;/defaultGoal&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
        &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;
        &lt;version&gt;${version.maven-bundle-plugin}&lt;/version&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;configuration&gt;
          &lt;instructions&gt;
            &lt;Bundle-SymbolicName&gt;CBRroute&lt;/Bundle-SymbolicName&gt;
            &lt;Bundle-Name&gt;Empty Camel Blueprint Example [CBRroute]&lt;/Bundle-Name&gt;
          &lt;/instructions&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
        &lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">3.5</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>&lt;/version&gt;
        &lt;configuration&gt;
          &lt;source&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1.8</span>&lt;/source&gt;
          &lt;target&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1.8</span>&lt;/target&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
        &lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">3.0</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span>&lt;/version&gt;
        &lt;configuration&gt;
          &lt;encoding&gt;UTF-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">8</span>&lt;/encoding&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
        &lt;artifactId&gt;camel-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${camel.version}&lt;/version&gt;
        &lt;configuration&gt;
          &lt;useBlueprint&gt;true&lt;/useBlueprint&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
  
&lt;/project&gt;</pre></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e25379"></a>Running the JUnit test</h2></div></div></div><p>To run the test:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Switch to <span class="guilabel">JBoss</span> perspective to free up more
                    workspace.</p></li><li class="step"><p>Select the project root, <code class="filename">CBRroute</code>, in the
                        <span class="guilabel">Project Explorer</span>.</p></li><li class="step"><p>Open the context menu.</p></li><li class="step"><p>Select <span class="guimenu">Run As</span> &gt; <span class="guimenuitem">JUnit Test</span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>By default, <span class="guilabel">JUnit</span> view opens in the sidebar. (To
                        provide a better view, drag it to the bottom, right
                        panel that displays the <span class="guilabel">Console</span>,
                            <span class="guilabel">Servers</span>, and
                            <span class="guilabel">Properties</span> tabs.)</p></td></tr></table></div></li><li class="step"><p>If the test runs successfully, you'll see something like this:</p><div class="figure"><a name="JunitTestSuccess"></a><p class="title"><b>Figure&nbsp;6.&nbsp;Successful JUnit run</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/tutJunitResult2.png" width="544.0500000000001" alt="JUnit success"></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Sometimes the test fails the first time JUnit is run on a project. Rerunning the test ususally
                        results in a successful  outcome.</p></td></tr></table></div><p>When the test does fail, you'll see something like this:</p><div class="figure"><a name="RiderTutorialJUnitFig030"></a><p class="title"><b>Figure&nbsp;7.&nbsp;Failed JUnit run</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/tutJunitResult.png" width="642.2" alt="JUnit failure"></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>JUnit will fail if your execution environment is not set to Java SE 8 or 7. The message bar at
                        the top of the JUnit tab will display an error message indicating that it
                        cannot find the correct SDK. </p><p>To resolve the issue, open the project's context menu, and select <span class="guimenu">Run As</span> &gt; <span class="guisubmenu">Run Configurations</span> &gt; <span class="guimenuitem">JRE tab</span> . Click the <span class="guibutton">Environments</span> button next to
                        the <span class="guilabel">Execution environment</span> field to locate and select a
                        Java SE 8 or 7 environment.</p></td></tr></table></div></li><li class="step"><p>Examine the output and take action to resolve any test failures.</p><p>To see more of the errors displayed in the JUnit panel,
                    click <span class="inlinemediaobject"><img src="images/maximize.gif" width="19.2" alt="Maximize button"></span> on the panel's menu bar to maximize the
                    view. </p><p>Before you run the JUnit test case again, delete any
                    JUnit-generated test messages from the CBRroute project's
                        <code class="filename">/src/data</code> folder in
                        <span class="guilabel">Project Explorer</span> (see <a class="xref" href="RiderTutorialJUnit.html#tutTraceMsgExample" title="Figure&nbsp;5.&nbsp;Trace-generated messages">Figure&nbsp;5, &#8220;Trace-generated messages&#8221;</a>).</p></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e25494"></a>Further reading</h2></div></div></div><p>To learn more about JUnit testing see <a class="link" href="http://www.junit.org/" target="_top">JUnit</a>.</p></div></div></body></html>