<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>HTTP4</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="RiderHTTPEptRef.html" title="HTTP Endpoints"><link rel="prev" href="http.html" title="HTTP"><link rel="next" href="jetty.html" title="Jetty"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry"><a name="http4"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>HTTP4 &#8212; provides endpoints for consuming external HTTP resources
            using Apache HttpClient 4.x</p></div><div class="refsection"><a name="d0e36661"></a><h2>Overview</h2><p>
            <span class="bold"><strong>Available as of Camel 2.3</strong></span>
        </p><p>The HTTP4 component provides HTTP based endpoints for consuming
            external HTTP resources (as a client to call external servers using
            HTTP).</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p><span class="bold"><strong>camel-http4 vs camel-jetty</strong></span>:
                You can only produce to endpoints generated by the HTTP4
                component. Therefore it should never be used as input into your
                Camel Routes. To bind/expose an HTTP endpoint via a HTTP server
                as input to a Camel route, use the <a class="link" href="jetty.html" title="Jetty">Jetty</a>
                component instead.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p><span class="bold"><strong>camel-http4 vs camel-http</strong></span>:
                Camel-http4 uses HttpClient 4.x while camel-http uses HttpClient
                3.x.</p></td></tr></table></div></div><div class="refsection"><a name="d0e36684"></a><h2>URI format</h2><p>The URI format for an HTTP4 endpoint is:</p><pre class="programlisting">http(s)4:<em class="replaceable"><code>hostname</code></em>[:<em class="replaceable"><code>port</code></em>][/<em class="replaceable"><code>resourceUri</code></em>][?<em class="replaceable"><code>options</code></em>]</pre><p>By default the port is set to <code class="code">80</code> for HTTP and to
                <code class="code">443</code> for HTTPS.</p><p>You can append query options to the URI in the following format,
                <code class="literal">?option=value&amp;option=value&amp;...</code>
        </p></div><div class="refsection"><a name="d0e36716"></a><h2>Dependencies</h2><p>Maven users will need to add a dependency on
                <code class="code">camel-http4</code> to their <code class="filename">pom.xml</code>
            for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-http4<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre></div><div class="refsection"><a name="Http4ComponentOptions"></a><h2>Http component options</h2><table width="1019" id="d0e36732"><col width="22%"><col width="14%"><col width="64%"><tr>
                <th> Name </th>
                <th> Default Value </th>
                <th> Description </th>
            </tr><tr>
                <td>
                    <code class="literal">maxTotalConnections</code>
                </td>
                <td>
                    <code class="literal">200</code>
                </td>
                <td> The maximum number of connections. </td>
            </tr><tr>
                <td>
                    <code class="literal">connectionsPerRoute</code>
                </td>
                <td>
                    <code class="literal">20</code>
                </td>
                <td> The maximum number of connections per route. </td>
            </tr><tr>
                <td>
                    <code class="literal">cookieStore</code>
                </td>
                <td>
                    <code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11.2/2.12.0:</strong></span> To use
                    a custom
                        <code class="literal">org.apache.http.client.CookieStore</code>.
                    By default the
                        <code class="literal">org.apache.http.impl.client.BasicCookieStore</code>
                    is used which is an in-memory only cookie store. Notice if
                        <code class="literal">bridgeEndpoint=true</code> then the cookie
                    store is forced to be a noop cookie store as cookies
                    shouldn't be stored as we are just bridging (eg acting as a
                    proxy). </td>
            </tr><tr>
                <td>
                    <code class="literal">httpClientConfigurer</code>
                </td>
                <td>
                    <code class="literal">null</code>
                </td>
                <td>Reference to a
                        <code class="literal">org.apache.camel.component.http.HttpClientConfigurer</code>
                    in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.</td>
            </tr><tr>
                <td>
                    <code class="literal">clientConnectionManager</code>
                </td>
                <td>
                    <code class="literal">null</code>
                </td>
                <td>To use a custom
                        <code class="literal">org.apache.http.conn.ClientConnectionManager</code>.
                </td>
            </tr><tr>
                <td>
                    <code class="literal">httpBinding</code>
                </td>
                <td>
                    <code class="literal">null</code>
                </td>
                <td>To use a custom
                        <code class="literal">org.apache.camel.component.http.HttpBinding</code>.
                </td>
            </tr><tr>
                <td>
                    <code class="literal">httpContext</code>
                </td>
                <td>
                    <code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.9.2:</strong></span> To use a
                    custom
                        <code class="literal">org.apache.http.protocol.HttpContext</code>
                    when executing requests. </td>
            </tr><tr>
                <td>
                    <code class="literal">sslContextParameters</code>
                </td>
                <td>
                    <code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.8:</strong></span> To use a custom
                        <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>.
                    See <a class="link" href="Http4UsingtheJSSEConfigurationUtility" target="_top">Using the JSSE Configuration Utility</a>. </td>
            </tr><tr>
                <td>
                    <code class="literal">x509HostnameVerifier</code>
                </td>
                <td>
                    <code class="literal">BrowserCompat</code><code class="literal">Hostname</code><code class="literal">Verifier</code>
                </td>
                <td><span class="bold"><strong>Camel 2.7:</strong></span> You can refer to
                    a different
                        <code class="literal">org.apache.http.conn.ssl.X509HostnameVerifier</code>
                    instance in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>
                    such as
                        <code class="literal">org.apache.http.conn.ssl.StrictHostnameVerifier</code>
                    or
                        <code class="literal">org.apache.http.conn.ssl.AllowAllHostnameVerifier</code>.
                </td>
            </tr><tr>
                <td>
                    <code class="literal">connectionTimeToLive</code>
                </td>
                <td>
                    <code class="literal">-1</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11.0:</strong></span> The time for
                    connection to live, the time unit is millisecond, the
                    default value is always keep alive. </td>
            </tr></table></div><div class="refsection"><a name="d0e36973"></a><h2>Http endpoint options</h2><p><a class="xref" href="http4.html#HTTP4RefOptsTbl" title="Table&nbsp;27.&nbsp;HTTP4 endpoint options">Table&nbsp;27, &#8220;HTTP4 endpoint options&#8221;</a> lists the options for an HTTP4
            endpoint.</p><div class="table"><a name="HTTP4RefOptsTbl"></a><p class="title"><b>Table&nbsp;27.&nbsp;HTTP4 endpoint options</b></p><div class="table-contents"><table summary="HTTP4 endpoint options" width="100%" border="1"><colgroup><col width="20%" class="c1"><col width="17%" class="c2"><col width="63%" class="c3"></colgroup><thead><tr><th>Name</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>
                            <code class="literal">throwExceptionOn</code><code class="literal">Failure</code>
                        </td><td>
                            <code class="literal">true</code>
                        </td><td>Option to disable throwing the
                                <code class="literal">HttpOperationFailedException</code>
                            in case of failed responses from the remote server.
                            This allows you to get all responses regardless of
                            the HTTP status code. </td></tr><tr><td>
                            <code class="literal">bridgeEndpoint</code>
                        </td><td>
                            <code class="literal">false</code>
                        </td><td> If true, HttpProducer will ignore the
                            Exchange.HTTP_URI header, and use the endpoint's URI
                            for request. You may also set the <span class="bold"><strong>throwExcpetionOnFailure</strong></span>
                            to be false to let the HttpProducer send all fault
                            responses back. Also if set to true HttpProducer and
                            CamelServlet will skip the gzip processing if the
                            content-encoding is "gzip". </td></tr><tr><td>
                            <code class="literal">clearExpired</code><code class="literal">Cookies</code>
                        </td><td>
                            <code class="literal">true</code>
                        </td><td><span class="bold"><strong>Camel
                                2.11.2/2.12.0:</strong></span> Whether to clear
                            expired cookies before sending the HTTP request.
                            This ensures the cookies store does not keep growing
                            by adding new cookies which is newer removed when
                            they are expired. </td></tr><tr><td>
                            <code class="literal">cookieStore</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Camel
                                2.11.2/2.12.0:</strong></span> To use a custom
                                <code class="literal">org.apache.http.client.CookieStore</code>.
                            By default the
                                <code class="literal">org.apache.http.impl.client.BasicCookieStore</code>
                            is used which is an in-memory only cookie store.
                            Notice if <code class="literal">bridgeEndpoint=true</code>
                            then the cookie store is forced to be a noop cookie
                            store as cookies shouldn't be stored as we are just
                            bridging (eg acting as a proxy). </td></tr><tr><td>
                            <code class="literal">disableStreamCache</code>
                        </td><td>
                            <code class="literal">false</code>
                        </td><td> DefaultHttpBinding will copy the request input
                            stream into a stream cache and put it into the
                            message body if this option is false to support
                            multiple reads, otherwise DefaultHttpBinding will
                            set the request input stream directly in the message
                            body. </td></tr><tr><td>
                            <code class="literal">headerFilter</code><code class="literal">Strategy</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Camel 2.10.4:</strong></span>
                            Reference to a instance of
                                <code class="literal">org.apache.camel.spi.HeaderFilterStrategy</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.t will be used to apply the
                            custom headerFilterStrategy on the new create
                            HttpEndpoint. </td></tr><tr><td>
                            <code class="literal">httpBindingRef</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Deprecated and will be
                                removed in Camel 3.0:</strong></span> Reference to a
                                <code class="literal">org.apache.camel.component.http.HttpBinding</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>. Use
                            the <code class="literal">httpBinding</code> option instead. </td></tr><tr><td>
                            <code class="literal">httpBinding</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td>To use a custom
                                <code class="literal">org.apache.camel.component.http.HttpBinding</code>. </td></tr><tr><td>
                            <code class="literal">httpClient</code><code class="literal">ConfigurerRef</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Deprecated and will be
                                removed in Camel 3.0:</strong></span> Reference to a
                                <code class="literal">org.apache.camel.component.http.HttpClientConfigurer</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>. Use
                            the <code class="literal">httpClientConfigurer</code> option
                            instead. </td></tr><tr><td>
                            <code class="literal">httpClient</code><code class="literal">Configurer</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Reference to a
                                <code class="literal">org.apache.camel.component.http.HttpClientConfigurer</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.
                        </td></tr><tr><td>
                            <code class="literal">httpContextRef</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Deprecated and will be
                                removed in Camel 3.0:</strong></span><span class="bold"><strong>Camel 2.9.2:</strong></span> Reference to
                            a custom
                                <code class="literal">org.apache.http.protocol.HttpContext</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>. Use
                            the <code class="literal">httpContext</code> option instead.
                        </td></tr><tr><td>
                            <code class="literal">httpContext</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Camel 2.9.2:</strong></span> To
                            use a custom
                                <code class="literal">org.apache.http.protocol.HttpContext</code>
                            when executing requests. </td></tr><tr><td>
                            <code class="literal">httpClient.XXX</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td>Setting options on the <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/BasicHttpParams.html" target="_top">BasicHttpParams</a>. For instance
                                <code class="literal">httpClient.soTimeout=5000</code>
                            will set the <code class="literal">SO_TIMEOUT</code> to 5
                            seconds. Look on the setter methods of the following
                            parameter beans for a complete reference: <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/auth/params/AuthParamBean.html" target="_top">AuthParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/params/ClientParamBean.html" target="_top">ClientParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/params/ConnConnectionParamBean.html" target="_top">ConnConnectionParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/params/ConnRouteParamBean.html" target="_top">ConnRouteParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/cookie/params/CookieSpecParamBean.html" target="_top">CookieSpecParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/HttpConnectionParamBean.html" target="_top">HttpConnectionParamBean</a> and <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/HttpProtocolParamBean.html" target="_top">HttpProtocolParamBean</a>
                        </td></tr><tr><td>
                            <code class="literal">clientConnection</code><code class="literal">Manager</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td>To use a custom
                                <code class="literal">org.apache.http.conn.ClientConnectionManager</code>. </td></tr><tr><td>
                            <code class="literal">transferException</code>
                        </td><td>
                            <code class="literal">false</code>
                        </td><td>If enabled and an <a class="link" href="http://camel.apache.org/exchange.html" target="_top">Exchange</a> failed processing on the
                            consumer side, and if the caused
                                <code class="literal">Exception</code> was send back
                            serialized in the response as a
                                <code class="literal">application/x-java-serialized-object</code>
                            content type (for example using <a href="PLUGINS_ROOT/org.fusesource.ide.help/jetty.html" class="olink">Jetty</a> or <a href="PLUGINS_ROOT/org.fusesource.ide.help/servlet.html" class="olink">Servlet</a> Camel
                            components). On the producer side the exception will
                            be deserialized and thrown as is, instead of the
                                <code class="literal">HttpOperationFailedException</code>.
                            The caused exception is required to be serialized. </td></tr><tr><td>
                            <code class="literal">sslContext</code><code class="literal">ParametersRef</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Deprecated to be removed in
                                Camel 3.0:</strong></span><span class="bold"><strong>Camel
                                2.8:</strong></span> Reference to a
                                <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.
                                <span class="bold"><strong>Important:</strong></span> Only
                            one instance of
                                <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>
                            is supported per HttpComponent. If you need to use
                            two or more different instances, you must define a
                            new HttpComponent per instance. See further below
                            for more details. See <a class="link" href="Http4UsingtheJSSEConfigurationUtility" target="_top">Using the JSSE Configuration Utility</a>.
                            Use the <code class="literal">sslContextParameters</code>
                            option instead. </td></tr><tr><td>
                            <code class="literal">sslContext</code><code class="literal">Parameters</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Camel 2.11.1:</strong></span>
                            Reference to a
                                <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>
                            in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.
                                <span class="bold"><strong>Important:</strong></span> Only
                            one instance of
                                <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>
                            is supported per HttpComponent. If you need to use 2
                            or more different instances, you need to define a
                            new HttpComponent per instance you need. See further
                            below for more details. See <a class="link" href="Http4UsingtheJSSEConfigurationUtility" target="_top">Using the JSSE Configuration Utility</a>.
                        </td></tr><tr><td>
                            <code class="literal">x509Hostname</code><code class="literal">Verifier</code>
                        </td><td>
                            <code class="literal">BrowserCompat</code><code class="literal">Hostname</code><code class="literal">Verifier</code>
                        </td><td><span class="bold"><strong>Camel 2.7:</strong></span> You
                            can refer to a different
                                <code class="literal">org.apache.http.conn.ssl.X509HostnameVerifier</code>
                            instance in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a> such as
                                <code class="literal">org.apache.http.conn.ssl.StrictHostnameVerifier</code>
                            or
                                <code class="literal">org.apache.http.conn.ssl.AllowAllHostnameVerifier</code>.
                        </td></tr><tr><td>
                            <code class="literal">urlRewrite</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td><span class="bold"><strong>Camel
                                2.11:</strong></span><span class="bold"><strong>Producer
                                only</strong></span> Refers to a custom
                                <code class="literal">org.apache.camel.component.http4.UrlRewrite</code>
                            which allows you to rewrite urls when you
                            bridge/proxy endpoints. See more details at <a class="link" href="http://camel.apache.org/urlrewrite.html" target="_top">http://camel.apache.org/urlrewrite.html</a> and 
                            <a class="link" href="http://camel.apache.org/how-to-use-camel-as-a-http-proxy-between-a-client-and-server.html" target="_top">How to use Camel as a HTTP proxy between a
                                client and server</a>. </td></tr></tbody></table></div></div><br class="table-break"></div><div class="refsection"><a name="d0e37456"></a><h2>Authentication and proxy options</h2><p>The following authentication options can also be set on the HTTP4
            endpoint:</p><div class="informaltable"><table width="100%" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th>Name</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>
                            <code class="literal">username</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Username for authentication. </td></tr><tr><td>
                            <code class="literal">password</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Password for authentication. </td></tr><tr><td>
                            <code class="literal">domain</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The domain name for authentication. </td></tr><tr><td>
                            <code class="literal">host</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The host name authentication. </td></tr><tr><td>
                            <code class="literal">proxyHost</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy host name </td></tr><tr><td>
                            <code class="literal">proxyPort</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy port number </td></tr><tr><td>
                            <code class="literal">proxyUsername</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Username for proxy authentication </td></tr><tr><td>
                            <code class="literal">proxyPassword</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Password for proxy authentication </td></tr><tr><td>
                            <code class="literal">proxyDomain</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy domain name </td></tr><tr><td>
                            <code class="literal">proxyNtHost</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy Nt host name </td></tr><tr><td>
                            <code class="literal">authUsername</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Username for authentication </td></tr><tr><td>
                            <code class="literal">authPassword</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Password for authentication </td></tr><tr><td>
                            <code class="literal">authDomain</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The domain name for authentication </td></tr><tr><td>
                            <code class="literal">authHost</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The host name authentication </td></tr><tr><td>
                            <code class="literal">proxyAuthHost</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy host name </td></tr><tr><td>
                            <code class="literal">proxyAuthPort</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy port number </td></tr><tr><td>
                            <code class="literal">proxyAuthScheme</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy scheme, will fallback and use the
                            scheme from the endpoint if not configured. </td></tr><tr><td>
                            <code class="literal">proxyAuthUsername</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Username for proxy authentication </td></tr><tr><td>
                            <code class="literal">proxyAuthPassword</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> Password for proxy authentication </td></tr><tr><td>
                            <code class="literal">proxyAuthDomain</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy domain name </td></tr><tr><td>
                            <code class="literal">proxyAuthNtHost</code>
                        </td><td>
                            <code class="literal">null</code>
                        </td><td> The proxy Nt host name </td></tr></tbody></table></div></div><div class="refsection"><a name="d0e37745"></a><h2>Message headers</h2><p>The following <code class="code">Exchange</code> properties are recognized by
            HTTP4 endpoints:</p><div class="table"><a name="d0e37753"></a><p class="title"><b>Table&nbsp;28.&nbsp;HTTP Exchange properties</b></p><div class="table-contents"><table summary="HTTP Exchange properties" width="100%" border="1"><colgroup><col width="32%" class="c1"><col width="10%" class="c2"><col width="58%" class="c3"></colgroup><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">Exchange.HTTP_URI</code>
                        </td><td><code class="literal">String</code>
                        </td><td>URI to call. Will override existing URI set
                            directly on the endpoint. </td></tr><tr><td><code class="literal">Exchange.HTTP_PATH</code>
                        </td><td><code class="literal">String</code>
                        </td><td>Request URI's path, the header will be used to
                            build the request URI with the HTTP_URI. </td></tr><tr><td><code class="literal">Exchange.HTTP_QUERY</code>
                        </td><td><code class="literal">String</code>
                        </td><td>URI parameters. Will override existing URI
                            parameters set directly on the endpoint. </td></tr><tr><td><code class="literal">Exchange.HTTP_RESPONSE_CODE</code>
                        </td><td><code class="literal">int</code>
                        </td><td>The HTTP response code from the external server.
                            Is 200 for OK. </td></tr><tr><td><code class="literal">Exchange.HTTP_CHARACTER_</code><code class="literal">ENCODING</code>
                        </td><td><code class="literal">String</code>
                        </td><td>Character encoding. </td></tr><tr><td><code class="literal">Exchange.CONTENT_TYPE</code>
                        </td><td><code class="literal">String</code>
                        </td><td>The HTTP content type. Is set on both the IN and
                            OUT message to provide a content type, such as
                                <code class="literal">text/html</code>. </td></tr><tr><td><code class="literal">Exchange.CONTENT_ENCODING</code>
                        </td><td><code class="literal">String</code>
                        </td><td>The HTTP content encoding. Is set on both the IN
                            and OUT message to provide a content encoding, such
                            as <code class="literal">gzip</code>. </td></tr></tbody></table></div></div><br class="table-break"></div><div class="refsection"><a name="d0e37854"></a><h2>Message Body</h2><p>Apache Camel will store the HTTP response from the external server
            on the OUT body. All headers from the IN message will be copied to
            the OUT message, so headers are preserved during routing.
            Additionally, Apache Camel will add the HTTP response headers as
            well to the OUT message headers.</p></div><div class="refsection"><a name="d0e37859"></a><h2>Response code</h2><p>Apache Camel will handle according to the HTTP response
            code:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Response code is in the range 100..299, Apache Camel
                    regards it as a success response.</p></li><li class="listitem"><p>Response code is in the range 300..399, Apache Camel
                    regards it as a redirection response and will throw a
                        <code class="exceptionname">HttpOperationFailedException</code>
                    with the information.</p></li><li class="listitem"><p>Response code is 400+, Apache Camel regards it as an
                    external server failure and will throw a
                        <code class="exceptionname">HttpOperationFailedException</code>
                    with the information.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The option, <code class="code">throwExceptionOnFailure</code>, can
                        be set to <code class="code">false</code> to prevent the
                            <code class="exceptionname">HttpOperationFailedException</code>
                        from being thrown for failed response codes. This allows
                        you to get any response from the remote server. See the
                        sample below which demonstrates this.</p></td></tr></table></div></li></ul></div></div><div class="refsection"><a name="Http4OperationFailedException"></a><h2>HttpOperationFailedException</h2><p>This exception contains the following information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The HTTP status code</p></li><li class="listitem"><p>The HTTP status line (text of the status code)</p></li><li class="listitem"><p>Redirect location, if server returned a redirect</p></li><li class="listitem"><p>Response body as a <code class="literal">java.lang.String</code>, if
                    server provided a body as response</p></li></ul></div></div><div class="refsection"><a name="Http4CallingusingGETorPOST"></a><h2>Calling using GET or POST</h2><p>The following algorithm is used to determine whether the
                <code class="literal">GET</code> or <code class="literal">POST</code> HTTP method
            should be used: 1. Use method provided in header. 2.
                <code class="literal">GET</code> if query string is provided in header. 3.
                <code class="literal">GET</code> if endpoint is configured with a query
            string. 4. <code class="literal">POST</code> if there is data to send (body is
            not null). 5. <code class="literal">GET</code> otherwise.</p></div><div class="refsection"><a name="Http4HowtogetaccesstoHttpServletRequestandHttpServletResponse"></a><h2>How to get access to HttpServletRequest and
            HttpServletResponse</h2><p>You can get access to these two using the Camel type converter
            system using <span class="bold"><strong>NOTE</strong></span> You can get the
            request and response not just from the processor after the
            camel-jetty or camel-cxf endpoint.</p><pre class="programlisting">
HttpServletRequest request = exchange.getIn().getBody(HttpServletRequest.class);
HttpServletRequest response = exchange.getIn().getBody(HttpServletResponse.class);
</pre></div><div class="refsection"><a name="Http4ConfiguringURItocall"></a><h2>Configuring URI to call</h2><p>You can set the HTTP producer's URI directly form the endpoint
            URI. In the route below, Camel will call out to the external server,
                <code class="literal">oldhost</code>, using HTTP.</p><pre class="programlisting">
from("direct:start")
	    .to("http4://oldhost");
</pre><p>And the equivalent Spring sample:</p><pre class="programlisting">
&lt;camelContext xmlns="http://activemq.apache.org/camel/schema/spring"&gt;
  &lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;to uri="http4://oldhost"/&gt;
  &lt;/route&gt;
&lt;/camelContext&gt;
</pre><p>You can override the HTTP endpoint URI by adding a header with the
            key, <code class="literal">Exchange.HTTP_URI</code>, on the message.</p><pre class="programlisting">from("direct:start")
  .setHeader(Exchange.HTTP_URI, constant("http://newhost"))
  .to("http4://oldhost");</pre><p>In the sample above Camel will call the <a class="link" href="http://newhost" target="_top">http://newhost</a> despite the
            endpoint is configured with <a class="link" href="http4://oldhost" target="_top">http4://oldhost</a>. Where Constants is the class,
                <code class="literal">org.apache.camel.component.http4.Constants</code>.
            If the http4 endpoint is working in bridge mode, it will ignore the
            message header of <code class="literal">Exchange.HTTP_URI</code>.</p></div><div class="refsection"><a name="Http4ConfiguringURIParameters"></a><h2>Configuring URI Parameters</h2><p>The <span class="bold"><strong>http</strong></span> producer supports URI
            parameters to be sent to the HTTP server. The URI parameters can
            either be set directly on the endpoint URI or as a header with the
            key <code class="literal">Exchange.HTTP_QUERY</code> on the message.</p><pre class="programlisting">
from("direct:start")
 .to("http4://oldhost?order=123&amp;detail=short");
</pre><p>Or options provided in a header:</p><pre class="programlisting">
from("direct:start")
  .setHeader(Exchange.HTTP_QUERY, constant("order=123&amp;detail=short"))
  .to("http4://oldhost");
</pre></div><div class="refsection"><a name="Http4HowtosetthehttpmethodGETPOSTPUTDELETEHEADOPTIONSTRACEtotheHTTPproducer"></a><h2>How to set the http method
            (GET/POST/PUT/DELETE/HEAD/OPTIONS/TRACE) to the HTTP
            producer</h2><p>The HTTP4 component provides a way to set the HTTP request method
            by setting the message header. Here is an example:</p><pre class="programlisting">
from("direct:start")
  .setHeader(Exchange.HTTP_METHOD, constant(org.apache.camel.component.http4.HttpMethods.POST))
  .to("http4://www.google.com")
  .to("mock:results");
</pre><p>The method can be written a bit shorter using the string
            constants:</p><pre class="programlisting">
.setHeader("CamelHttpMethod", constant("POST"))
</pre><p>And the equivalent Spring sample:</p><pre class="programlisting">
&lt;camelContext xmlns="http://activemq.apache.org/camel/schema/spring"&gt;
  &lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;setHeader headerName="CamelHttpMethod"&gt;
        &lt;constant&gt;POST&lt;/constant&gt;
    &lt;/setHeader&gt;
    &lt;to uri="http4://www.google.com"/&gt;
    &lt;to uri="mock:results"/&gt;
  &lt;/route&gt;
&lt;/camelContext&gt;
</pre></div><div class="refsection"><a name="Http4UsingclienttimeoutSOTIMEOUT"></a><h2>Using client timeout - SO_TIMEOUT</h2><p>See the <a class="link" href="https://svn.apache.org/repos/asf/camel/trunk/components/camel-http4/src/test/java/org/apache/camel/component/http4/HttpSOTimeoutTest.java" target="_top">HttpSOTimeoutTest</a> unit test.</p></div><div class="refsection"><a name="Http4ConfiguringaProxy"></a><h2>Configuring a Proxy</h2><p>The HTTP4 component provides a way to configure a proxy.</p><pre class="programlisting">
from("direct:start")
  .to("http4://oldhost?proxyAuthHost=www.myproxy.com&amp;proxyAuthPort=80");
</pre><p>There is also support for proxy authentication via the
                <code class="literal">proxyAuthUsername</code> and
                <code class="literal">proxyAuthPassword</code> options.</p></div><div class="refsection"><a name="Http4UsingproxysettingsoutsideofURI"></a><h2>Using proxy settings outside of URI</h2><p>To avoid System properties conflicts, you can set proxy
            configuration only from the CamelContext or URI. Java DSL :</p><pre class="programlisting">
 context.getProperties().put("http.proxyHost", "172.168.18.9");
 context.getProperties().put("http.proxyPort" "8080");
</pre><p>Spring XML</p><pre class="programlisting">
   &lt;camelContext&gt;
       &lt;properties&gt;
           &lt;property key="http.proxyHost" value="172.168.18.9"/&gt;
           &lt;property key="http.proxyPort" value="8080"/&gt;
      &lt;/properties&gt;
   &lt;/camelContext&gt;
</pre><p>Camel will first set the settings from Java System or CamelContext
            Properties and then the endpoint proxy options if provided. So you
            can override the system properties with the endpoint options.</p><p>Notice in <span class="bold"><strong>Camel 2.8</strong></span> there is also
            a <code class="literal">http.proxyScheme</code> property you can set to
            explicit configure the scheme to use.</p></div><div class="refsection"><a name="Http4Configuringcharset"></a><h2>Configuring charset</h2><p>If you are using <code class="literal">POST</code> to send data you can
            configure the <code class="literal">charset</code> using the
                <code class="literal">Exchange</code> property:</p><pre class="programlisting">
exchange.setProperty(Exchange.CHARSET_NAME, "ISO-8859-1");
</pre></div><div class="refsection"><a name="Http4Samplewithscheduledpoll"></a><h2>Sample with scheduled poll</h2><p>This sample polls the Google homepage every 10 seconds and write
            the page to the file <code class="literal">message.html</code>:</p><pre class="programlisting">
from("timer://foo?fixedRate=true&amp;delay=0&amp;period=10000")
    .to("http4://www.google.com")
    .setHeader(FileComponent.HEADER_FILE_NAME, "message.html")
    .to("file:target/google");
</pre></div><div class="refsection"><a name="Http4URIParametersfromtheendpointURI"></a><h2>URI Parameters from the endpoint URI</h2><p>In this sample we have the complete URI endpoint that is just what
            you would have typed in a web browser. Multiple URI parameters can
            of course be set using the <code class="literal">&amp;</code> character as
            separator, just as you would in the web browser. Camel does no
            tricks here.</p><pre class="programlisting">
// we query for Camel at the Google page
template.sendBody("http4://www.google.com/search?q=Camel", null);
</pre></div><div class="refsection"><a name="Http4URIParametersfromtheMessage"></a><h2>URI Parameters from the Message</h2><pre class="programlisting">
Map headers = new HashMap();
headers.put(HttpProducer.QUERY, "q=Camel&amp;lr=lang_en");
// we query for Camel and English language at Google
template.sendBody("http4://www.google.com/search", null, headers);
</pre><p>In the header value above notice that it should <span class="bold"><strong>not</strong></span> be prefixed with <code class="literal">?</code>
            and you can separate parameters as usual with the
                <code class="literal">&amp;</code> char.</p></div><div class="refsection"><a name="Http4GettingtheResponseCode"></a><h2>Getting the Response Code</h2><p>You can get the HTTP response code from the HTTP4 component by
            getting the value from the Out message header with
                <code class="literal">HttpProducer.HTTP_RESPONSE_CODE</code>.</p><pre class="programlisting">Exchange exchange = template.send("http4://www.google.com/search", new Processor() {
  public void process(Exchange exchange) throws Exception {
    exchange.getIn().setHeader(HttpProducer.QUERY, constant("hl=en&amp;q=activemq"));
  }
});
Message out = exchange.getOut();
int responseCode = out.getHeader(HttpProducer.HTTP_RESPONSE_CODE, Integer.class);</pre></div><div class="refsection"><a name="_Http4DisablingCookies"></a><h2>Disabling Cookies</h2><p>To disable cookies you can set the HTTP Client to ignore cookies
            by adding this URI option:
                <code class="literal">httpClient.cookiePolicy=ignoreCookies</code>
        </p></div><div class="refsection"><a name="Http4AdvancedUsage"></a><h2>Advanced Usage</h2><p>If you need more control over the HTTP producer you should use the
                <code class="literal">HttpComponent</code> where you can set various
            classes to give you custom behavior.</p></div><div class="refsection"><a name="Http4UsingtheJSSEConfigurationUtility"></a><h2>Using the JSSE Configuration Utility</h2><p>As of Camel 2.8, the HTTP4 component supports SSL/TLS
            configuration through the <a class="link" href="Http4UsingtheJSSEConfigurationUtility" target="_top">Camel JSSE
                Configuration Utility</a>. This utility greatly
            decreases the amount of component specific code you need to write
            and is configurable at the endpoint and component levels. The
            following examples demonstrate how to use the utility with the HTTP4
            component.</p></div><div class="refsection"><a name="Http4Programmaticconfigurationofthecomponent"></a><h2>Programmatic configuration of the component</h2><pre class="programlisting">
KeyStoreParameters ksp = new KeyStoreParameters();
ksp.setResource("/users/home/server/keystore.jks");
ksp.setPassword("keystorePassword");

KeyManagersParameters kmp = new KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword("keyPassword");

SSLContextParameters scp = new SSLContextParameters();
scp.setKeyManagers(kmp);

HttpComponent httpComponent = getContext().getComponent("http4", HttpComponent.class);
httpComponent.setSslContextParameters(scp);
</pre></div><div class="refsection"><a name="Http4SpringDSLbasedconfigurationofendpoint"></a><h2>Spring DSL based configuration of endpoint</h2><pre class="programlisting">
...
  &lt;camel:sslContextParameters
      id="sslContextParameters"&gt;
    &lt;camel:keyManagers
        keyPassword="keyPassword"&gt;
      &lt;camel:keyStore
          resource="/users/home/server/keystore.jks"
          password="keystorePassword"/&gt;
    &lt;/camel:keyManagers&gt;
  &lt;/camel:sslContextParameters&gt;...
...
  &lt;to uri="https4://127.0.0.1/mail/?sslContextParametersRef=sslContextParameters"/&gt;...
</pre></div><div class="refsection"><a name="Http4ConfiguringApacheHTTPClientDirectly"></a><h2>Configuring Apache HTTP Client Directly</h2><p>Basically camel-http4 component is built on the top of <a class="link" href="http://hc.apache.org/" target="_top">Apache HTTP client</a>.
            Please see <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d4e537" target="_top">SSL/TLS customization</a> for details or have a look into
            the
                <code class="literal">org.apache.camel.component.http4.HttpsServerTestSupport</code>
            unit test base class. You can also implement a custom
                <code class="literal">org.apache.camel.component.http4.HttpClientConfigurer</code>
            to do some configuration on the http client if you need full control
            of it.</p><p>However if you <span class="emphasis"><em>just</em></span> want to specify the
            keystore and truststore you can do this with Apache HTTP
                <code class="literal">HttpClientConfigurer</code>, for example:</p><pre class="programlisting">
KeyStore keystore = ...;
KeyStore truststore = ...;

SchemeRegistry registry = new SchemeRegistry();
registry.register(new Scheme("https", 443, new SSLSocketFactory(keystore, "mypassword", truststore)));
</pre><p>And then you need to create a class that implements
                <code class="literal">HttpClientConfigurer</code>, and registers https
            protocol providing a keystore or truststore per example above. Then,
            from your camel route builder class you can hook it up like
            so:</p><pre class="programlisting">
HttpComponent httpComponent = getContext().getComponent("http4", HttpComponent.class);
httpComponent.setHttpClientConfigurer(new MyHttpClientConfigurer());
</pre><p>If you are doing this using the Spring DSL, you can specify your
                <code class="literal">HttpClientConfigurer</code> using the URI. For
            example:</p><pre class="programlisting">
&lt;bean id="myHttpClientConfigurer"
 class="my.https.HttpClientConfigurer"&gt;
&lt;/bean&gt;

&lt;to uri="https4://myhostname.com:443/myURL?httpClientConfigurer=myHttpClientConfigurer"/&gt;
</pre><p>As long as you implement the HttpClientConfigurer and configure
            your keystore and truststore as described above, it will work
            fine.</p></div><div class="refsection"><a name="Http4UsingHTTPStoauthenticategotchas"></a><h2>Using HTTPS to authenticate gotchas</h2><p>An end user reported that he had problem with authenticating with
            HTTPS. The problem was eventually resolved by providing a custom
            configured
            <code class="literal">org.apache.http.protocol.HttpContext</code>:</p><p>1. Create a (Spring) factory for HttpContexts:</p><pre class="programlisting">
public class HttpContextFactory {

  private String httpHost = "localhost";
  private String httpPort = 9001;

  private BasicHttpContext httpContext = new BasicHttpContext();
  private BasicAuthCache authCache = new BasicAuthCache();
  private BasicScheme basicAuth = new BasicScheme();

  public HttpContext getObject() {
    authCache.put(new HttpHost(httpHost, httpPort), basicAuth);

    httpContext.setAttribute(ClientContext.AUTH_CACHE, authCache);

    return httpContext;
  }

  // getter and setter
}
</pre><p>2. Declare an HttpContext in the Spring application context
            file:</p><pre class="programlisting">
&lt;bean id="myHttpContext" factory-bean="httpContextFactory" factory-method="getObject"/&gt;
</pre><p>3. Reference the context in the http4 URL:</p><pre class="programlisting">
&lt;to uri="https4://myhostname.com:443/myURL?httpContext=myHttpContext"/&gt;
</pre></div><div class="refsection"><a name="Http4UsingdifferentSSLContextParameters"></a><h2>Using different SSLContextParameters</h2><p>The HTTP4 component supports only one instance of
                <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>
            per component. If you need to use two or more different instances,
            you need to setup multiple components as shown below. Here we have two
            components, each using their own instance of
                <code class="literal">sslContextParameters</code> property.</p><pre class="programlisting">
&lt;bean id="http4-foo" class="org.apache.camel.component.http4.HttpComponent"&gt;
   &lt;property name="sslContextParameters" ref="sslContextParams1"/&gt;
   &lt;property name="x509HostnameVerifier" ref="hostnameVerifier"/&gt;
&lt;/bean&gt;

&lt;bean id="http4-bar" class="org.apache.camel.component.http4.HttpComponent"&gt;
   &lt;property name="sslContextParameters" ref="sslContextParams2"/&gt;
   &lt;property name="x509HostnameVerifier" ref="hostnameVerifier"/&gt;
&lt;/bean&gt;
</pre></div><div class="refsection"><a name="d0e38229"></a><h2>Related topics</h2><table border="0" summary="Simple list" class="simplelist"><tr><td>
                <a class="xref" href="http.html" title="HTTP">HTTP</a>
            </td></tr><tr><td>
                <a class="xref" href="jetty.html" title="Jetty">Jetty</a>
            </td></tr><tr><td>
                <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/BasicHttpParams.html" target="_top">BasicHttpParams</a>
            </td></tr></table></div></div></body></html>