<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>JT400</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><link rel="home" href="index.html" title="Red Hat Fuse IDE"><link rel="up" href="RiderCompRef.html" title="Endpoint Reference"><link rel="prev" href="jsch.html" title="Jsch"><link rel="next" href="language.html" title="Language"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="jt400"></a>JT400</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_JT400Component"></a>JT/400 Component</h2></div></div></div><p>The <span class="bold"><strong><code class="literal">jt400</code></strong></span> component allows you to exchanges
            messages with an AS/400 system using data queues.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">jt400://user:password@system/QSYS.LIB/LIBRARY.LIB/QUEUE.DTAQ[?options]</pre><p>To call a remote program (<span class="bold"><strong>Camel 2.7</strong></span>)</p><pre class="programlisting">jt400://user:password@system/QSYS.LIB/LIBRARY.LIB/program.PGM[?options]</pre><p>You can append query options to the URI in the following format,
                <code class="literal">?option=value&amp;option=value&amp;...</code>
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_URIoptions"></a>URI options</h2></div></div></div><p>For the data queue message exchange:</p><div class="table"><a name="_IDU_JT400_URIopts"></a><p class="title"><b>Table&nbsp;58.&nbsp;Message exchange uri options</b></p><div class="table-contents"><table summary="Message exchange uri options" width="100%" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th> Name </th><th> Default value </th><th> Description </th></tr></thead><tbody><tr><td>
                    <code class="literal">ccsid</code>
                </td><td> default system CCSID </td><td> Specifies the CCSID to use for the connection with the AS/400 system. </td></tr><tr><td>
                    <code class="literal">format</code>
                </td><td>
                    <code class="literal">text</code>
                </td><td> Specifies the data format for sending messages valid options are: <code class="literal">text</code>
                    (represented by <code class="literal">String</code>) and <code class="literal">binary</code> (represented by
                        <code class="literal">byte[]</code>) </td></tr><tr><td>
                    <code class="literal">consumer.delay</code>
                </td><td>
                    <code class="literal">500</code>
                </td><td> Delay in milliseconds between each poll. </td></tr><tr><td>
                    <code class="literal">consumer.initialDelay</code>
                </td><td>
                    <code class="literal">1000</code>
                </td><td> Milliseconds before polling starts. </td></tr><tr><td>
                    <code class="literal">consumer.userFixedDelay</code>
                </td><td>
                    <code class="literal">false</code>
                </td><td><code class="literal">true</code> to use fixed delay between polls, otherwise fixed rate is used.
                    See <a class="link" href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html" target="_top">ScheduledExecutorService</a> in JDK for details. </td></tr><tr><td>
                    <code class="literal">guiAvailable</code>
                </td><td>
                    <code class="literal">false</code>
                </td><td>Specifies whether AS/400 is available in the environment running Camel.</td></tr><tr><td>
                    <code class="literal">keyed</code>
                </td><td>
                    <code class="literal">false</code>
                </td><td>Specifies whether to use keyed or nonkeyed data queues.</td></tr><tr><td>
                    <code class="literal">searchKey</code>
                </td><td>
                    <code class="literal">null</code>
                </td><td>Specifies the search key to use for keyed data queues.</td></tr><tr><td>
                    <code class="literal">searchType</code>
                </td><td>
                    <code class="literal">EQ</code>
                </td><td>Specifies the search type. Valid values are <code class="literal">EQ</code>, <code class="literal">NE</code>,
                        <code class="literal">LT</code>, <code class="literal">LE</code>, <code class="literal">GT</code>, or
                        <code class="literal">GE</code>.</td></tr><tr><td>
                    <code class="literal">connectionPool</code>
                </td><td>
                    <code class="literal">AS400ConnectionPool</code> instance </td><td>Reference to a <code class="literal">com.ibm.as400.access.AS400ConnectionPool</code> instance in the
                    Registr, which is used for obtaining connections to the AS/400 system. The lookup notation
                    ('#' character) should be used.</td></tr></tbody></table></div></div><br class="table-break"><p>For the remote program call (<span class="bold"><strong>Camel 2.7</strong></span>):</p><div class="table"><a name="d0e43570"></a><p class="title"><b>Table&nbsp;59.&nbsp;RPC uri options</b></p><div class="table-contents"><table summary="RPC uri options" width="100%" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th> Name </th><th> Default value </th><th> Description </th></tr></thead><tbody><tr><td>
                    <code class="literal">outputFieldsIdx</code>
                </td><td>&nbsp;</td><td> Specifies which fields (program parameters) are output parameters. </td></tr><tr><td>
                    <code class="literal">fieldsLength</code>
                </td><td>&nbsp;</td><td> Specifies the fields (program parameters) length as in the AS/400 program definition.
                </td></tr></tbody></table></div></div><br class="table-break"></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_Usage"></a>Usage</h2></div></div></div><p>When configured as a consumer endpoint, the endpoint will poll a data queue on a remote system.
            For every entry on the data queue, a new <code class="literal">Exchange</code> is sent with the entry's data
            in the <span class="emphasis"><em>In</em></span> message's body, formatted either as a <code class="literal">String</code> or
            a <code class="literal">byte[]</code>, depending on the format. For a provider endpoint, the
                <span class="emphasis"><em>In</em></span> message body contents will be put on the data queue as either raw
            bytes or text.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_RemoteprogramcallCamel27"></a>Remote program call (<span class="bold"><strong>Camel 2.7</strong></span>)</h2></div></div></div><p>This endpoint expects the input to be a String array and handles all the CCSID handling trough
            the native jt400 library mechanisms. After the program execution the endpoint returns a String
            array with the values as they were returned by the program (the input only parameters will contain
            the same data as the beginning of the invocation) This endpoint does not implement a provider
            endpoint!</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_Example"></a>Example</h2></div></div></div><p>In the snippet below, the data for an exchange sent to the <code class="literal">direct:george</code>
            endpoint will be put in the data queue <code class="literal">PENNYLANE</code> in library
                <code class="literal">BEATLES</code> on a system named <code class="literal">LIVERPOOL</code>. Another user
            connects to the same data queue to receive the information from the data queue and forward it to
            the <code class="literal">mock:ringo</code> endpoint.</p><pre class="programlisting">public class Jt400RouteBuilder extends RouteBuilder {

    @Override
    public void configure() throws Exception {
       from("direct:george").to("jt400://GEORGE:EGROEG@LIVERPOOL/QSYS.LIB/BEATLES.LIB/PENNYLANE.DTAQ");
       from("jt400://RINGO:OGNIR@LIVERPOOL/QSYS.LIB/BEATLES.LIB/PENNYLANE.DTAQ").to("mock:ringo");
    }
}</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_JT400_HSH_RemoteprogramcallexampleCamel27"></a>Remote program call example (<span class="bold"><strong>Camel 2.7</strong></span>)</h2></div></div></div><p>In the snippet below, the data Exchange sent to the direct:work endpoint will contain three
            string that will be used as the arguments for the program "compute" in the library "assets". This
            program will write the output values in the 2nd and 3rd parameters. All the parameters will be
            sent to the direct:play endpoint.</p><pre class="programlisting">public class Jt400RouteBuilder extends RouteBuilder {
    @Override
    public void configure() throws Exception {
       from("direct:work").to("jt400://GRUPO:ATWORK@server/QSYS.LIB/assets.LIB/compute.PGM?fieldsLength=10,10,512&amp;ouputFieldsIdx=2,3").to("direct:play");
    }
}</pre></div></div></body></html>